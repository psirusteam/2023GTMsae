<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.165">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Andrés Gutiérrez - Stalyn Guerrero">

<title>Modelos lineales y modelos de vinculo logístico en R y STAN</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="2Modelos Lineal y vinculo logistico_files/libs/clipboard/clipboard.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/quarto.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/popper.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/anchor.min.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="2Modelos Lineal y vinculo logistico_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="2Modelos Lineal y vinculo logistico_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="2Modelos Lineal y vinculo logistico_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="2Modelos Lineal y vinculo logistico_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Modelos lineales y modelos de vinculo logístico en R y STAN</h1>
<p class="subtitle lead">CEPAL - Unidad de Estadísticas Sociales</p>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Andrés Gutiérrez - Stalyn Guerrero </p>
          </div>
  </div>
    
    
  </div>
  

</header>

<section id="modelos-lineales." class="level2">
<h2 class="anchored" data-anchor-id="modelos-lineales.">Modelos lineales.</h2>
<p>La regresión lineal es la técnica básica del análisis econométrico. Mediante dicha técnica tratamos de determinar relaciones de dependencia de tipo lineal entre una variable dependiente o endógena, respecto de una o varias variables explicativas o exógenas.</p>
<p><span class="math display">\[
\begin{eqnarray*}
\left[\begin{array}{c}
Y_{1}\\
Y_{2}\\
\vdots\\
Y_{n}
\end{array}\right] &amp; = &amp; \left[\begin{array}{cccc}
1 &amp; x_{11} &amp; \cdots &amp; x_{1k}\\
1 &amp; x_{21} &amp; \cdots &amp; x_{2k}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; x_{n1} &amp; \cdots &amp; x_{nk}
\end{array}\right]\left[\begin{array}{c}
\beta_{0}\\
\beta_{1}\\
\vdots\\
\beta_{k}
\end{array}\right]+\left[\begin{array}{c}
\epsilon_{1}\\
\epsilon_{2}\\
\vdots\\
\epsilon_{n}
\end{array}\right]
\end{eqnarray*}
\]</span> escrita de forma general sería</p>
<p><span class="math display">\[
\begin{align*}
\boldsymbol{Y} &amp; = &amp; \boldsymbol{X\beta} + \boldsymbol{\epsilon} \\
E\left(\boldsymbol{Y}\mid \boldsymbol{X}\right) &amp; = &amp; \boldsymbol{XB}
\end{align*}
\]</span></p>
<p>donde <span class="math inline">\(\boldsymbol{\epsilon} \sim N\left( 0, \sigma^2\boldsymbol{I}_n\right)\)</span> y el estimador de <span class="math inline">\(B\)</span> esta dado por:</p>
<p><span class="math display">\[
\boldsymbol{\hat{B}}=\boldsymbol{\left(X^{T}X\right)^{-1}X^{T}Y}
\]</span></p>
</section>
<section id="modelos-lineales-bayesiano." class="level2">
<h2 class="anchored" data-anchor-id="modelos-lineales-bayesiano.">Modelos lineales bayesiano.</h2>
<p>En primer lugar, nótese que el interés particular recae en la distribución del vector de <span class="math inline">\(n\)</span> variables aleatorias <span class="math inline">\(\mathbf{Y}=(Y_1\ldots,Y_n)'\)</span> condicional a la matriz de variables auxiliares <span class="math inline">\(\mathbf{X}\)</span> e indexada por el vector de parámetros de interés <span class="math inline">\(\boldsymbol{\beta}=(\beta_0,\ldots,\beta_k)'\)</span> dada por <span class="math inline">\(p(\mathbf{Y} \mid \boldsymbol{\beta},\mathbf{X})\)</span>.</p>
<p>El modelo básico y clásico asume que la verosimilitud para las variables de interés es</p>
<p><span class="math display">\[
\begin{equation*}
\mathbf{Y} \mid \boldsymbol{\beta},\sigma^2,\mathbf{X}\sim N_n(\mathbf{X}\boldsymbol{\beta},\sigma^2\mathbf{I}_n)
\end{equation*}
\]</span></p>
<p>en donde <span class="math inline">\(\mathbf{I}_n\)</span> denota la matriz identidad de orden <span class="math inline">\(n\times n\)</span>. Por supuesto, el modelo normal no es el único que se puede postular como verosimilitud para los datos.</p>
<section id="parámetros-dependientes." class="level3">
<h3 class="anchored" data-anchor-id="parámetros-dependientes.">Parámetros dependientes.</h3>
<p>Los parámetros de interés son <span class="math inline">\(\boldsymbol{\beta}\)</span> y <span class="math inline">\(\sigma^2\)</span> y su distribuciones previa conjunta se supone que está dada por</p>
<p><span class="math display">\[
\begin{equation*}
p(\boldsymbol{\beta},\sigma^2)=p(\boldsymbol{\beta} \mid \sigma^2)p(\sigma^2)
\end{equation*}
\]</span></p>
<p>Específicamente, la distribución previa del parámetro <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionada a <span class="math inline">\(\sigma^2\)</span> es informativa y está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2 \sim N_q(\mathbf{b},\sigma^2\mathbf{B})
\end{equation*}
\]</span></p>
<p>en donde <span class="math inline">\(\mathbf{b}\)</span> es un vector de medias y <span class="math inline">\(\mathbf{B}\)</span> es una matriz de varianzas simétrica y definida positiva. Por otro lado, la distribución previa del parámetro <span class="math inline">\(\sigma^2\)</span> también se considera informativa y dada por</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \sim Inversa-Gamma\left( \frac{n_0}{2}, \frac{n_0\sigma^2_0}{2} \right)
\end{equation*}
\]</span></p>
<p>La distribución posterior conjunta de los parámetros de interés <span class="math inline">\(\boldsymbol{\beta},\sigma^2\)</span> está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\boldsymbol{\beta},\sigma^2 \mid \mathbf{Y},\mathbf{X})
&amp;=(\sigma^2)^{-q/2}
\exp\left\{-\frac{1}{2\sigma^2}(\boldsymbol{\beta}-\mathbf{b}_q)'\mathbf{B}_q^{-1}(\boldsymbol{\beta}-\mathbf{b}_q)\right\}
\notag
\\ &amp;\hspace{3cm} \times
(\sigma^2)^{-n_1/2-1}
\exp\left\{-\frac{n_1\sigma^2_1}{2\sigma^2}\right\}
\end{align}
\]</span> donde</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}_q &amp;= \left(\mathbf{B}^{-1}+\mathbf{X}'\mathbf{X}\right)^{-1}\\
\mathbf{b}_q &amp;=\mathbf{B}_q\left(\mathbf{B}^{-1}\mathbf{b}+\mathbf{X}'\mathbf{Y}\right)
\end{align*}
\]</span></p>
<p>y además</p>
<p><span class="math display">\[
\begin{align*}
n_1&amp;=n_0+n\\
n_1\sigma^2_1&amp;=
n_0\sigma^2_0+(\mathbf{Y}-\mathbf{X}\mathbf{b}_q)'\mathbf{Y}+(\mathbf{b}-\mathbf{b}_q)'\mathbf{B}^{-1}\mathbf{b}
\end{align*}
\]</span></p>
<p>donde <span class="math inline">\(n_0\)</span> denota el número de datos previos. La distribución posterior conjunta de los parámetros de interés tiene la forma de la distribución Normal-Gamma.</p>
<p>La distribución posterior del vector de parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionada a <span class="math inline">\(\sigma^2,\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2,\mathbf{Y},\mathbf{X} \sim N_q(\mathbf{b}_q,\sigma^2\mathbf{B}_q)
\end{equation*}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\sigma^2\)</span> condicionada es</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \mid \mathbf{Y},\mathbf{X} \sim Inversa-Gamma\left(\frac{n_1}{2},\frac{\sigma^2_1}{2}\right)
\end{equation*}
\]</span></p>
</section>
<section id="parámetros-independientes" class="level3">
<h3 class="anchored" data-anchor-id="parámetros-independientes">Parámetros independientes</h3>
<p>En esta ocasión se considera que los parámetros son independientes previa; es decir que la distribución previa conjunta está dada por</p>
<p><span class="math display">\[
\begin{equation*}
p(\boldsymbol{\beta},\sigma^2)=p(\boldsymbol{\beta})p(\sigma^2)
\end{equation*}
\]</span></p>
<p>Como es natural, la distribución previa del vector de parámetros <span class="math inline">\(\boldsymbol{\beta}\)</span> es normal, aunque esta vez la matriz de varianzas no va a depender del otro parámetro <span class="math inline">\(\sigma^2\)</span>, por lo tanto se tiene que</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span></p>
<p>Igualmente, el parámetro <span class="math inline">\(\sigma^2\)</span> no depende de <span class="math inline">\(\boldsymbol{\beta}\)</span> y es posible asignarle la siguiente distribución previa</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2\sim Inversa-Gamma\left(\frac{n_0}{2},\frac{n_0\sigma^2_0}{2}\right)
\end{equation*}
\]</span></p>
<p>la distribución posterior conjunta de <span class="math inline">\(\boldsymbol{\beta}\)</span> y <span class="math inline">\(\sigma^2\)</span> puede ser escrita como</p>
<p><span class="math display">\[
\begin{align}
p(\boldsymbol{\beta},\sigma^2 \mid \mathbf{Y},\mathbf{X})&amp;\propto p(\mathbf{Y} \mid \boldsymbol{\beta},\sigma^2)p(\boldsymbol{\beta})p(\sigma^2)\notag \\
&amp;\propto (\sigma^2)^{-n/2} \exp\left\{-\frac{1}{2\sigma^2}\left(Q(\boldsymbol{\beta})+S^2_e\right)\right\}\notag\\
&amp;\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
(\sigma^2)^{-n_0/2-1} \exp\left\{-\frac{n_0\sigma^2_0}{2\sigma^2}\right\}\notag\\
&amp;=(\sigma^2)^{-\frac{n+n_0}{2}-1}
\exp\left\{-\frac{1}{2\sigma^2}\left[Q(\boldsymbol{\beta})+S^2_e+n_0\sigma^2_0\right]\right\} \notag \\
&amp;\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\boldsymbol{\beta}\)</span> condicionado a <span class="math inline">\(\sigma^2,\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta} \mid \sigma^2,\mathbf{Y},\mathbf{X} \sim N_q(\mathbf{b}_q,\mathbf{B}_q)
\end{equation*}
\]</span></p>
<p>donde</p>
<p><span class="math display">\[
\begin{align*}
\mathbf{B}_q &amp;= \left(\mathbf{B}^{-1}+\frac{1}{\sigma^2}\mathbf{X}'\mathbf{X}\right)^{-1}\\
\mathbf{b}_q &amp;=\mathbf{B}_q\left(\mathbf{B}^{-1}\mathbf{b}+\frac{1}{\sigma^2}\mathbf{X}'\mathbf{Y}\right)
\end{align*}
\]</span></p>
<p>La distribución posterior del parámetro <span class="math inline">\(\sigma^2\)</span> condicionado a <span class="math inline">\(\boldsymbol{\beta},\mathbf{Y},\mathbf{X}\)</span> es</p>
<p><span class="math display">\[
\begin{equation*}
\sigma^2 \mid \boldsymbol{\beta},\mathbf{Y},\mathbf{X} \sim Inversa-Gamma\left( \frac{n_1}{2}, \frac{n_1\sigma_{\boldsymbol{\beta}}^2}{2}  \right)
\end{equation*}
\]</span></p>
<p>donde <span class="math inline">\(n_1=n+n_0\)</span>,<br>
<span class="math display">\[
\begin{align*}
n_1\sigma_{\boldsymbol{\beta}}^2&amp;=&amp;Q(\boldsymbol{\beta})+S^2_e+n_0\sigma^2_0\\
Q(\boldsymbol{\beta})&amp;=&amp;(\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})'(\mathbf{X}'\mathbf{X})(\boldsymbol{\beta}-\hat{\boldsymbol{\beta}})\\
S^2_e&amp;=&amp;(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})'(\mathbf{y}-\mathbf{X}\hat{\boldsymbol{\beta}})
\end{align*}
\]</span></p>
<p>y <span class="math inline">\(\sigma^2_0\)</span> es una estimación previa del parámetro de interés <span class="math inline">\(\sigma^2\)</span>.</p>
</section>
<section id="práctica-en-stan-modelo-lineal-simple" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-modelo-lineal-simple">Práctica en <strong>STAN</strong> (Modelo lineal simple)</h3>
<ul>
<li>ENCUESTA CONTINUA DE HOGARES (ECH) 2020</li>
</ul>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-1_52d92ccdf8b4a0b1fe96a12e6aaca699">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>encuesta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/encuestaGTM14N.rds"</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;</span> <span class="dv">18</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>statelevel_predictors_df <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../Data/statelevel_predictors_df.rds"</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>datalm <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">dam =</span> <span class="fu">str_pad</span>(dam_ee, <span class="at">pad =</span> <span class="st">"0"</span>, <span class="at">width =</span> <span class="dv">2</span>), </span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>  ingcorte) <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span> </span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(  <span class="at">Promedio =</span> <span class="fu">log</span>(<span class="fu">mean</span>(ingcorte))) <span class="sc">%&gt;%</span> </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">left_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"dam"</span>)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(datalm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> dam </th>
   <th style="text-align:right;"> Promedio </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivos </th>
   <th style="text-align:right;"> suelo_urbanos </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> eliminar_basura </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> hacinamiento </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 7.8248 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 25.4075 </td>
   <td style="text-align:right;"> 12.3671 </td>
   <td style="text-align:right;"> 13.5749 </td>
   <td style="text-align:right;"> 0.9124 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.5193 </td>
   <td style="text-align:right;"> 0.2915 </td>
   <td style="text-align:right;"> 0.2128 </td>
   <td style="text-align:right;"> 0.1624 </td>
   <td style="text-align:right;"> 0.0657 </td>
   <td style="text-align:right;"> 0.3094 </td>
   <td style="text-align:right;"> 0.3764 </td>
   <td style="text-align:right;"> 0.1137 </td>
   <td style="text-align:right;"> 0.1346 </td>
   <td style="text-align:right;"> 0.2125 </td>
   <td style="text-align:right;"> 0.0089 </td>
   <td style="text-align:right;"> 0.0963 </td>
   <td style="text-align:right;"> 0.1474 </td>
   <td style="text-align:right;"> 0.1479 </td>
   <td style="text-align:right;"> 0.5846 </td>
   <td style="text-align:right;"> 0.0561 </td>
   <td style="text-align:right;"> 0.0979 </td>
   <td style="text-align:right;"> 0.0228 </td>
   <td style="text-align:right;"> 0.1776 </td>
   <td style="text-align:right;"> 0.0662 </td>
   <td style="text-align:right;"> 0.3385 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 6.9414 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 3.0275 </td>
   <td style="text-align:right;"> 25.3519 </td>
   <td style="text-align:right;"> 0.9920 </td>
   <td style="text-align:right;"> 0.5176 </td>
   <td style="text-align:right;"> 0.0015 </td>
   <td style="text-align:right;"> 0.5065 </td>
   <td style="text-align:right;"> 0.2867 </td>
   <td style="text-align:right;"> 0.1893 </td>
   <td style="text-align:right;"> 0.1490 </td>
   <td style="text-align:right;"> 0.0696 </td>
   <td style="text-align:right;"> 0.4022 </td>
   <td style="text-align:right;"> 0.2926 </td>
   <td style="text-align:right;"> 0.0350 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 0.6296 </td>
   <td style="text-align:right;"> 0.0629 </td>
   <td style="text-align:right;"> 0.1756 </td>
   <td style="text-align:right;"> 0.4667 </td>
   <td style="text-align:right;"> 0.5596 </td>
   <td style="text-align:right;"> 0.8879 </td>
   <td style="text-align:right;"> 0.1277 </td>
   <td style="text-align:right;"> 0.0776 </td>
   <td style="text-align:right;"> 0.0270 </td>
   <td style="text-align:right;"> 0.0573 </td>
   <td style="text-align:right;"> 0.1377 </td>
   <td style="text-align:right;"> 0.4128 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 7.4195 </td>
   <td style="text-align:right;"> 0.0230 </td>
   <td style="text-align:right;"> 19.9710 </td>
   <td style="text-align:right;"> 9.2249 </td>
   <td style="text-align:right;"> 7.4542 </td>
   <td style="text-align:right;"> 0.8847 </td>
   <td style="text-align:right;"> 0.0028 </td>
   <td style="text-align:right;"> 0.5107 </td>
   <td style="text-align:right;"> 0.3031 </td>
   <td style="text-align:right;"> 0.2042 </td>
   <td style="text-align:right;"> 0.1447 </td>
   <td style="text-align:right;"> 0.0602 </td>
   <td style="text-align:right;"> 0.3918 </td>
   <td style="text-align:right;"> 0.3123 </td>
   <td style="text-align:right;"> 0.0665 </td>
   <td style="text-align:right;"> 0.4024 </td>
   <td style="text-align:right;"> 0.1464 </td>
   <td style="text-align:right;"> 0.0110 </td>
   <td style="text-align:right;"> 0.0725 </td>
   <td style="text-align:right;"> 0.3270 </td>
   <td style="text-align:right;"> 0.1923 </td>
   <td style="text-align:right;"> 0.7539 </td>
   <td style="text-align:right;"> 0.1173 </td>
   <td style="text-align:right;"> 0.1291 </td>
   <td style="text-align:right;"> 0.0266 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 0.1023 </td>
   <td style="text-align:right;"> 0.3886 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 6.8230 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 7.0750 </td>
   <td style="text-align:right;"> 11.8985 </td>
   <td style="text-align:right;"> 3.1658 </td>
   <td style="text-align:right;"> 0.5413 </td>
   <td style="text-align:right;"> 0.0030 </td>
   <td style="text-align:right;"> 0.5174 </td>
   <td style="text-align:right;"> 0.3069 </td>
   <td style="text-align:right;"> 0.1789 </td>
   <td style="text-align:right;"> 0.1245 </td>
   <td style="text-align:right;"> 0.0495 </td>
   <td style="text-align:right;"> 0.4451 </td>
   <td style="text-align:right;"> 0.2361 </td>
   <td style="text-align:right;"> 0.0289 </td>
   <td style="text-align:right;"> 0.7821 </td>
   <td style="text-align:right;"> 0.4722 </td>
   <td style="text-align:right;"> 0.0382 </td>
   <td style="text-align:right;"> 0.2644 </td>
   <td style="text-align:right;"> 0.6590 </td>
   <td style="text-align:right;"> 0.5784 </td>
   <td style="text-align:right;"> 0.8763 </td>
   <td style="text-align:right;"> 0.1530 </td>
   <td style="text-align:right;"> 0.0824 </td>
   <td style="text-align:right;"> 0.0064 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.1628 </td>
   <td style="text-align:right;"> 0.5231 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 7.2523 </td>
   <td style="text-align:right;"> 0.0525 </td>
   <td style="text-align:right;"> 7.1401 </td>
   <td style="text-align:right;"> 35.2899 </td>
   <td style="text-align:right;"> 2.2458 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.0033 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.3015 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.1375 </td>
   <td style="text-align:right;"> 0.0545 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.2994 </td>
   <td style="text-align:right;"> 0.0309 </td>
   <td style="text-align:right;"> 0.0510 </td>
   <td style="text-align:right;"> 0.5050 </td>
   <td style="text-align:right;"> 0.0324 </td>
   <td style="text-align:right;"> 0.4462 </td>
   <td style="text-align:right;"> 0.3742 </td>
   <td style="text-align:right;"> 0.5600 </td>
   <td style="text-align:right;"> 0.8798 </td>
   <td style="text-align:right;"> 0.1202 </td>
   <td style="text-align:right;"> 0.1214 </td>
   <td style="text-align:right;"> 0.0307 </td>
   <td style="text-align:right;"> 0.0512 </td>
   <td style="text-align:right;"> 0.1362 </td>
   <td style="text-align:right;"> 0.5027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 6.9429 </td>
   <td style="text-align:right;"> 0.0305 </td>
   <td style="text-align:right;"> 3.2267 </td>
   <td style="text-align:right;"> 26.5864 </td>
   <td style="text-align:right;"> 0.8061 </td>
   <td style="text-align:right;"> 0.4645 </td>
   <td style="text-align:right;"> 0.0039 </td>
   <td style="text-align:right;"> 0.5069 </td>
   <td style="text-align:right;"> 0.2929 </td>
   <td style="text-align:right;"> 0.1801 </td>
   <td style="text-align:right;"> 0.1433 </td>
   <td style="text-align:right;"> 0.0650 </td>
   <td style="text-align:right;"> 0.4243 </td>
   <td style="text-align:right;"> 0.2587 </td>
   <td style="text-align:right;"> 0.0311 </td>
   <td style="text-align:right;"> 0.1607 </td>
   <td style="text-align:right;"> 0.7005 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.2722 </td>
   <td style="text-align:right;"> 0.5872 </td>
   <td style="text-align:right;"> 0.6553 </td>
   <td style="text-align:right;"> 0.9029 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.0865 </td>
   <td style="text-align:right;"> 0.0379 </td>
   <td style="text-align:right;"> 0.0524 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.4720 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 6.6074 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 7.2985 </td>
   <td style="text-align:right;"> 8.7206 </td>
   <td style="text-align:right;"> 3.7948 </td>
   <td style="text-align:right;"> 0.6156 </td>
   <td style="text-align:right;"> 0.0018 </td>
   <td style="text-align:right;"> 0.5226 </td>
   <td style="text-align:right;"> 0.3085 </td>
   <td style="text-align:right;"> 0.1840 </td>
   <td style="text-align:right;"> 0.1261 </td>
   <td style="text-align:right;"> 0.0511 </td>
   <td style="text-align:right;"> 0.3822 </td>
   <td style="text-align:right;"> 0.2154 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.9638 </td>
   <td style="text-align:right;"> 0.7169 </td>
   <td style="text-align:right;"> 0.0485 </td>
   <td style="text-align:right;"> 0.0690 </td>
   <td style="text-align:right;"> 0.8503 </td>
   <td style="text-align:right;"> 0.6225 </td>
   <td style="text-align:right;"> 0.9198 </td>
   <td style="text-align:right;"> 0.1591 </td>
   <td style="text-align:right;"> 0.0482 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.2897 </td>
   <td style="text-align:right;"> 0.5434 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 6.6733 </td>
   <td style="text-align:right;"> 0.0161 </td>
   <td style="text-align:right;"> 8.5521 </td>
   <td style="text-align:right;"> 11.9767 </td>
   <td style="text-align:right;"> 5.8417 </td>
   <td style="text-align:right;"> 0.4896 </td>
   <td style="text-align:right;"> 0.0016 </td>
   <td style="text-align:right;"> 0.5310 </td>
   <td style="text-align:right;"> 0.3064 </td>
   <td style="text-align:right;"> 0.1627 </td>
   <td style="text-align:right;"> 0.1298 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.4401 </td>
   <td style="text-align:right;"> 0.1702 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 0.9801 </td>
   <td style="text-align:right;"> 0.7864 </td>
   <td style="text-align:right;"> 0.0513 </td>
   <td style="text-align:right;"> 0.3053 </td>
   <td style="text-align:right;"> 0.8603 </td>
   <td style="text-align:right;"> 0.8980 </td>
   <td style="text-align:right;"> 0.9318 </td>
   <td style="text-align:right;"> 0.2931 </td>
   <td style="text-align:right;"> 0.0102 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.0366 </td>
   <td style="text-align:right;"> 0.2904 </td>
   <td style="text-align:right;"> 0.6049 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 7.1523 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 9.4656 </td>
   <td style="text-align:right;"> 18.2660 </td>
   <td style="text-align:right;"> 6.0706 </td>
   <td style="text-align:right;"> 0.6155 </td>
   <td style="text-align:right;"> 0.0023 </td>
   <td style="text-align:right;"> 0.5272 </td>
   <td style="text-align:right;"> 0.3001 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> 0.1431 </td>
   <td style="text-align:right;"> 0.0627 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2586 </td>
   <td style="text-align:right;"> 0.0669 </td>
   <td style="text-align:right;"> 0.5089 </td>
   <td style="text-align:right;"> 0.4037 </td>
   <td style="text-align:right;"> 0.0394 </td>
   <td style="text-align:right;"> 0.2054 </td>
   <td style="text-align:right;"> 0.5427 </td>
   <td style="text-align:right;"> 0.5401 </td>
   <td style="text-align:right;"> 0.8210 </td>
   <td style="text-align:right;"> 0.0990 </td>
   <td style="text-align:right;"> 0.0321 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.1692 </td>
   <td style="text-align:right;"> 0.4582 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 7.0738 </td>
   <td style="text-align:right;"> 0.0338 </td>
   <td style="text-align:right;"> 5.1872 </td>
   <td style="text-align:right;"> 29.3599 </td>
   <td style="text-align:right;"> 1.6822 </td>
   <td style="text-align:right;"> 0.4799 </td>
   <td style="text-align:right;"> 0.0075 </td>
   <td style="text-align:right;"> 0.5091 </td>
   <td style="text-align:right;"> 0.2985 </td>
   <td style="text-align:right;"> 0.1764 </td>
   <td style="text-align:right;"> 0.1278 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.4026 </td>
   <td style="text-align:right;"> 0.2424 </td>
   <td style="text-align:right;"> 0.0285 </td>
   <td style="text-align:right;"> 0.3810 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.0606 </td>
   <td style="text-align:right;"> 0.3155 </td>
   <td style="text-align:right;"> 0.6388 </td>
   <td style="text-align:right;"> 0.6333 </td>
   <td style="text-align:right;"> 0.9022 </td>
   <td style="text-align:right;"> 0.1896 </td>
   <td style="text-align:right;"> 0.0949 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.1993 </td>
   <td style="text-align:right;"> 0.5800 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 7.0344 </td>
   <td style="text-align:right;"> 0.0426 </td>
   <td style="text-align:right;"> 4.8694 </td>
   <td style="text-align:right;"> 37.4208 </td>
   <td style="text-align:right;"> 1.4296 </td>
   <td style="text-align:right;"> 0.5734 </td>
   <td style="text-align:right;"> 0.0029 </td>
   <td style="text-align:right;"> 0.5112 </td>
   <td style="text-align:right;"> 0.2994 </td>
   <td style="text-align:right;"> 0.1774 </td>
   <td style="text-align:right;"> 0.1304 </td>
   <td style="text-align:right;"> 0.0596 </td>
   <td style="text-align:right;"> 0.3953 </td>
   <td style="text-align:right;"> 0.2727 </td>
   <td style="text-align:right;"> 0.0310 </td>
   <td style="text-align:right;"> 0.1497 </td>
   <td style="text-align:right;"> 0.6088 </td>
   <td style="text-align:right;"> 0.0596 </td>
   <td style="text-align:right;"> 0.4863 </td>
   <td style="text-align:right;"> 0.6480 </td>
   <td style="text-align:right;"> 0.7537 </td>
   <td style="text-align:right;"> 0.9001 </td>
   <td style="text-align:right;"> 0.2132 </td>
   <td style="text-align:right;"> 0.0750 </td>
   <td style="text-align:right;"> 0.0320 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.1704 </td>
   <td style="text-align:right;"> 0.5414 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:right;"> 6.6472 </td>
   <td style="text-align:right;"> 0.0255 </td>
   <td style="text-align:right;"> 5.7895 </td>
   <td style="text-align:right;"> 13.9958 </td>
   <td style="text-align:right;"> 2.6080 </td>
   <td style="text-align:right;"> 0.2538 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 0.5145 </td>
   <td style="text-align:right;"> 0.2818 </td>
   <td style="text-align:right;"> 0.1623 </td>
   <td style="text-align:right;"> 0.1258 </td>
   <td style="text-align:right;"> 0.0588 </td>
   <td style="text-align:right;"> 0.4354 </td>
   <td style="text-align:right;"> 0.1972 </td>
   <td style="text-align:right;"> 0.0264 </td>
   <td style="text-align:right;"> 0.3082 </td>
   <td style="text-align:right;"> 0.7269 </td>
   <td style="text-align:right;"> 0.0783 </td>
   <td style="text-align:right;"> 0.2898 </td>
   <td style="text-align:right;"> 0.7986 </td>
   <td style="text-align:right;"> 0.8373 </td>
   <td style="text-align:right;"> 0.9338 </td>
   <td style="text-align:right;"> 0.2352 </td>
   <td style="text-align:right;"> 0.0333 </td>
   <td style="text-align:right;"> 0.0116 </td>
   <td style="text-align:right;"> 0.0489 </td>
   <td style="text-align:right;"> 0.2222 </td>
   <td style="text-align:right;"> 0.6140 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:right;"> 6.4434 </td>
   <td style="text-align:right;"> 0.0210 </td>
   <td style="text-align:right;"> 2.0043 </td>
   <td style="text-align:right;"> 11.8076 </td>
   <td style="text-align:right;"> 1.5148 </td>
   <td style="text-align:right;"> 0.2796 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 0.5241 </td>
   <td style="text-align:right;"> 0.2873 </td>
   <td style="text-align:right;"> 0.1613 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.1227 </td>
   <td style="text-align:right;"> 0.0211 </td>
   <td style="text-align:right;"> 0.6500 </td>
   <td style="text-align:right;"> 0.6501 </td>
   <td style="text-align:right;"> 0.1352 </td>
   <td style="text-align:right;"> 0.3101 </td>
   <td style="text-align:right;"> 0.8202 </td>
   <td style="text-align:right;"> 0.8131 </td>
   <td style="text-align:right;"> 0.9168 </td>
   <td style="text-align:right;"> 0.3014 </td>
   <td style="text-align:right;"> 0.0251 </td>
   <td style="text-align:right;"> 0.0052 </td>
   <td style="text-align:right;"> 0.0404 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.6159 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 6.6262 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 1.6086 </td>
   <td style="text-align:right;"> 10.0401 </td>
   <td style="text-align:right;"> 0.7361 </td>
   <td style="text-align:right;"> 0.3230 </td>
   <td style="text-align:right;"> 0.0024 </td>
   <td style="text-align:right;"> 0.5203 </td>
   <td style="text-align:right;"> 0.2999 </td>
   <td style="text-align:right;"> 0.1543 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.0449 </td>
   <td style="text-align:right;"> 0.4133 </td>
   <td style="text-align:right;"> 0.1335 </td>
   <td style="text-align:right;"> 0.0142 </td>
   <td style="text-align:right;"> 0.8918 </td>
   <td style="text-align:right;"> 0.7871 </td>
   <td style="text-align:right;"> 0.1401 </td>
   <td style="text-align:right;"> 0.3138 </td>
   <td style="text-align:right;"> 0.8974 </td>
   <td style="text-align:right;"> 0.8772 </td>
   <td style="text-align:right;"> 0.9582 </td>
   <td style="text-align:right;"> 0.3939 </td>
   <td style="text-align:right;"> 0.0223 </td>
   <td style="text-align:right;"> 0.0129 </td>
   <td style="text-align:right;"> 0.0277 </td>
   <td style="text-align:right;"> 0.3674 </td>
   <td style="text-align:right;"> 0.6634 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 6.7605 </td>
   <td style="text-align:right;"> 0.0201 </td>
   <td style="text-align:right;"> 1.3088 </td>
   <td style="text-align:right;"> 12.8529 </td>
   <td style="text-align:right;"> 0.4211 </td>
   <td style="text-align:right;"> 0.4016 </td>
   <td style="text-align:right;"> 0.0026 </td>
   <td style="text-align:right;"> 0.5161 </td>
   <td style="text-align:right;"> 0.2968 </td>
   <td style="text-align:right;"> 0.1707 </td>
   <td style="text-align:right;"> 0.1249 </td>
   <td style="text-align:right;"> 0.0558 </td>
   <td style="text-align:right;"> 0.4003 </td>
   <td style="text-align:right;"> 0.2005 </td>
   <td style="text-align:right;"> 0.0264 </td>
   <td style="text-align:right;"> 0.6004 </td>
   <td style="text-align:right;"> 0.7507 </td>
   <td style="text-align:right;"> 0.1587 </td>
   <td style="text-align:right;"> 0.2574 </td>
   <td style="text-align:right;"> 0.7546 </td>
   <td style="text-align:right;"> 0.7979 </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 0.2960 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.0076 </td>
   <td style="text-align:right;"> 0.0481 </td>
   <td style="text-align:right;"> 0.2711 </td>
   <td style="text-align:right;"> 0.5392 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:right;"> 6.5395 </td>
   <td style="text-align:right;"> 0.0224 </td>
   <td style="text-align:right;"> 0.7126 </td>
   <td style="text-align:right;"> 12.5184 </td>
   <td style="text-align:right;"> 0.4974 </td>
   <td style="text-align:right;"> 0.3125 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 0.5038 </td>
   <td style="text-align:right;"> 0.2973 </td>
   <td style="text-align:right;"> 0.1724 </td>
   <td style="text-align:right;"> 0.1019 </td>
   <td style="text-align:right;"> 0.0398 </td>
   <td style="text-align:right;"> 0.3897 </td>
   <td style="text-align:right;"> 0.1610 </td>
   <td style="text-align:right;"> 0.0185 </td>
   <td style="text-align:right;"> 0.9296 </td>
   <td style="text-align:right;"> 0.8622 </td>
   <td style="text-align:right;"> 0.3541 </td>
   <td style="text-align:right;"> 0.5473 </td>
   <td style="text-align:right;"> 0.8818 </td>
   <td style="text-align:right;"> 0.8660 </td>
   <td style="text-align:right;"> 0.9424 </td>
   <td style="text-align:right;"> 0.5713 </td>
   <td style="text-align:right;"> 0.1333 </td>
   <td style="text-align:right;"> 0.0550 </td>
   <td style="text-align:right;"> 0.0367 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.7164 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 17 </td>
   <td style="text-align:right;"> 7.0634 </td>
   <td style="text-align:right;"> 0.0248 </td>
   <td style="text-align:right;"> 0.2952 </td>
   <td style="text-align:right;"> 28.4407 </td>
   <td style="text-align:right;"> 0.2350 </td>
   <td style="text-align:right;"> 0.4047 </td>
   <td style="text-align:right;"> 0.0029 </td>
   <td style="text-align:right;"> 0.4999 </td>
   <td style="text-align:right;"> 0.3131 </td>
   <td style="text-align:right;"> 0.1698 </td>
   <td style="text-align:right;"> 0.1117 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.4033 </td>
   <td style="text-align:right;"> 0.2185 </td>
   <td style="text-align:right;"> 0.0237 </td>
   <td style="text-align:right;"> 0.3024 </td>
   <td style="text-align:right;"> 0.9454 </td>
   <td style="text-align:right;"> 0.1586 </td>
   <td style="text-align:right;"> 0.3934 </td>
   <td style="text-align:right;"> 0.7241 </td>
   <td style="text-align:right;"> 0.8357 </td>
   <td style="text-align:right;"> 0.9083 </td>
   <td style="text-align:right;"> 0.3225 </td>
   <td style="text-align:right;"> 0.0450 </td>
   <td style="text-align:right;"> 0.1228 </td>
   <td style="text-align:right;"> 0.0454 </td>
   <td style="text-align:right;"> 0.2250 </td>
   <td style="text-align:right;"> 0.5325 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 18 </td>
   <td style="text-align:right;"> 7.1636 </td>
   <td style="text-align:right;"> 0.0346 </td>
   <td style="text-align:right;"> 0.7454 </td>
   <td style="text-align:right;"> 27.9997 </td>
   <td style="text-align:right;"> 0.6191 </td>
   <td style="text-align:right;"> 0.4102 </td>
   <td style="text-align:right;"> 0.0111 </td>
   <td style="text-align:right;"> 0.5061 </td>
   <td style="text-align:right;"> 0.3008 </td>
   <td style="text-align:right;"> 0.1780 </td>
   <td style="text-align:right;"> 0.1289 </td>
   <td style="text-align:right;"> 0.0533 </td>
   <td style="text-align:right;"> 0.4088 </td>
   <td style="text-align:right;"> 0.2479 </td>
   <td style="text-align:right;"> 0.0241 </td>
   <td style="text-align:right;"> 0.2824 </td>
   <td style="text-align:right;"> 0.7144 </td>
   <td style="text-align:right;"> 0.1412 </td>
   <td style="text-align:right;"> 0.3129 </td>
   <td style="text-align:right;"> 0.5191 </td>
   <td style="text-align:right;"> 0.6713 </td>
   <td style="text-align:right;"> 0.8758 </td>
   <td style="text-align:right;"> 0.2242 </td>
   <td style="text-align:right;"> 0.0885 </td>
   <td style="text-align:right;"> 0.0833 </td>
   <td style="text-align:right;"> 0.0431 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.5070 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:right;"> 7.3491 </td>
   <td style="text-align:right;"> 0.0360 </td>
   <td style="text-align:right;"> 2.6224 </td>
   <td style="text-align:right;"> 34.2277 </td>
   <td style="text-align:right;"> 1.5445 </td>
   <td style="text-align:right;"> 0.4421 </td>
   <td style="text-align:right;"> 0.0046 </td>
   <td style="text-align:right;"> 0.5100 </td>
   <td style="text-align:right;"> 0.2927 </td>
   <td style="text-align:right;"> 0.1818 </td>
   <td style="text-align:right;"> 0.1459 </td>
   <td style="text-align:right;"> 0.0685 </td>
   <td style="text-align:right;"> 0.4138 </td>
   <td style="text-align:right;"> 0.2424 </td>
   <td style="text-align:right;"> 0.0357 </td>
   <td style="text-align:right;"> 0.0196 </td>
   <td style="text-align:right;"> 0.5975 </td>
   <td style="text-align:right;"> 0.0908 </td>
   <td style="text-align:right;"> 0.1855 </td>
   <td style="text-align:right;"> 0.5241 </td>
   <td style="text-align:right;"> 0.5707 </td>
   <td style="text-align:right;"> 0.8760 </td>
   <td style="text-align:right;"> 0.1602 </td>
   <td style="text-align:right;"> 0.1781 </td>
   <td style="text-align:right;"> 0.0122 </td>
   <td style="text-align:right;"> 0.0593 </td>
   <td style="text-align:right;"> 0.1850 </td>
   <td style="text-align:right;"> 0.4456 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 6.8499 </td>
   <td style="text-align:right;"> 0.0247 </td>
   <td style="text-align:right;"> 1.6756 </td>
   <td style="text-align:right;"> 36.7507 </td>
   <td style="text-align:right;"> 1.0935 </td>
   <td style="text-align:right;"> 0.3738 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.5184 </td>
   <td style="text-align:right;"> 0.2940 </td>
   <td style="text-align:right;"> 0.1679 </td>
   <td style="text-align:right;"> 0.1280 </td>
   <td style="text-align:right;"> 0.0581 </td>
   <td style="text-align:right;"> 0.4066 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.0272 </td>
   <td style="text-align:right;"> 0.2684 </td>
   <td style="text-align:right;"> 0.7037 </td>
   <td style="text-align:right;"> 0.1674 </td>
   <td style="text-align:right;"> 0.3505 </td>
   <td style="text-align:right;"> 0.6923 </td>
   <td style="text-align:right;"> 0.7061 </td>
   <td style="text-align:right;"> 0.8775 </td>
   <td style="text-align:right;"> 0.3376 </td>
   <td style="text-align:right;"> 0.2379 </td>
   <td style="text-align:right;"> 0.0689 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.2760 </td>
   <td style="text-align:right;"> 0.5397 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 7.0736 </td>
   <td style="text-align:right;"> 0.0171 </td>
   <td style="text-align:right;"> 2.3243 </td>
   <td style="text-align:right;"> 36.0126 </td>
   <td style="text-align:right;"> 1.4146 </td>
   <td style="text-align:right;"> 0.6301 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.5163 </td>
   <td style="text-align:right;"> 0.3020 </td>
   <td style="text-align:right;"> 0.1663 </td>
   <td style="text-align:right;"> 0.1219 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.4309 </td>
   <td style="text-align:right;"> 0.1921 </td>
   <td style="text-align:right;"> 0.0269 </td>
   <td style="text-align:right;"> 0.3891 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.1146 </td>
   <td style="text-align:right;"> 0.2511 </td>
   <td style="text-align:right;"> 0.7212 </td>
   <td style="text-align:right;"> 0.7398 </td>
   <td style="text-align:right;"> 0.8985 </td>
   <td style="text-align:right;"> 0.3761 </td>
   <td style="text-align:right;"> 0.0427 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.0503 </td>
   <td style="text-align:right;"> 0.2224 </td>
   <td style="text-align:right;"> 0.5422 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 22 </td>
   <td style="text-align:right;"> 6.8561 </td>
   <td style="text-align:right;"> 0.0254 </td>
   <td style="text-align:right;"> 2.7178 </td>
   <td style="text-align:right;"> 52.3791 </td>
   <td style="text-align:right;"> 1.2857 </td>
   <td style="text-align:right;"> 0.5114 </td>
   <td style="text-align:right;"> 0.0037 </td>
   <td style="text-align:right;"> 0.5142 </td>
   <td style="text-align:right;"> 0.2928 </td>
   <td style="text-align:right;"> 0.1780 </td>
   <td style="text-align:right;"> 0.1436 </td>
   <td style="text-align:right;"> 0.0699 </td>
   <td style="text-align:right;"> 0.4247 </td>
   <td style="text-align:right;"> 0.2391 </td>
   <td style="text-align:right;"> 0.0296 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.0774 </td>
   <td style="text-align:right;"> 0.2188 </td>
   <td style="text-align:right;"> 0.6334 </td>
   <td style="text-align:right;"> 0.7355 </td>
   <td style="text-align:right;"> 0.9087 </td>
   <td style="text-align:right;"> 0.1964 </td>
   <td style="text-align:right;"> 0.0607 </td>
   <td style="text-align:right;"> 0.0100 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.1929 </td>
   <td style="text-align:right;"> 0.4749 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Diagrama de dispersión por las variables</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-2_9034e6a47f9ed2c25f22ed912084f49a">
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-2-1.png" style="height:150.0%" width="672"></p>
</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-3_71d713065687f9c8b2a51308550c5254">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  vector[n] x;      <span class="sc">/</span><span class="er">/</span> Variable predictora</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  vector[n] y;      <span class="sc">/</span><span class="er">/</span> Variable respuesta</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  real b0;            <span class="sc">/</span><span class="er">/</span> Intercepto</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  real b1;            <span class="sc">/</span><span class="er">/</span> Pendiente</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma2;  </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>transformed parameters{</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma;</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> <span class="fu">sqrt</span>(sigma2);</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>  b0 <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>);</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>  b1 <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">1000</span>);</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="sc">~</span> <span class="fu">inv_gamma</span>(<span class="fl">0.0001</span>, <span class="fl">0.0001</span>);</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x, sigma);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">normal_rng</span>(b0 <span class="sc">+</span> b1<span class="sc">*</span>x, sigma);</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-4_ae163942bb128fea421783e37b5eb970">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(cmdstanr)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Definir el modelo</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="co">#file.edit("../Data/modelosStan/7ModeloLm.stan")</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>fitLm1 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/7ModeloLm.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-5_17d6e36219064cbe965fab4dd2a69280">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalm),</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> datalm<span class="sc">$</span>tiene_internet ,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalm<span class="sc">$</span>Promedio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-6_98abdfd174551bedb1647e273e16a854">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>model_fitLm1 <span class="ot">&lt;-</span> fitLm1<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 1.2 seconds.
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 1.1 seconds.
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 1.1 seconds.
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 1.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 1.1 seconds.
Total execution time: 1.8 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-7_60aee04a11501b4c574a84f8606c2422">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>model_fitLm1<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"b0"</span>,<span class="st">"b1"</span>,<span class="st">"sigma2"</span>,<span class="st">"sigma"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> b0 </td>
   <td style="text-align:right;"> 9.9686 </td>
   <td style="text-align:right;"> 9.9569 </td>
   <td style="text-align:right;"> 0.4803 </td>
   <td style="text-align:right;"> 0.4702 </td>
   <td style="text-align:right;"> 9.1778 </td>
   <td style="text-align:right;"> 10.7744 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> b1 </td>
   <td style="text-align:right;"> -3.4177 </td>
   <td style="text-align:right;"> -3.4010 </td>
   <td style="text-align:right;"> 0.5434 </td>
   <td style="text-align:right;"> 0.5289 </td>
   <td style="text-align:right;"> -4.3203 </td>
   <td style="text-align:right;"> -2.5260 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma2 </td>
   <td style="text-align:right;"> 0.0402 </td>
   <td style="text-align:right;"> 0.0374 </td>
   <td style="text-align:right;"> 0.0138 </td>
   <td style="text-align:right;"> 0.0117 </td>
   <td style="text-align:right;"> 0.0233 </td>
   <td style="text-align:right;"> 0.0656 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma </td>
   <td style="text-align:right;"> 0.1979 </td>
   <td style="text-align:right;"> 0.1933 </td>
   <td style="text-align:right;"> 0.0326 </td>
   <td style="text-align:right;"> 0.0309 </td>
   <td style="text-align:right;"> 0.1525 </td>
   <td style="text-align:right;"> 0.2562 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-8_6e043c0ae752c25a62db8aedd80a00c7">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(posterior)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(bayesplot)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(patchwork)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)) <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)))<span class="sc">/</span> </span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b0"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-9_1cd637c259c6fc3ae0cd5f385d6a2014">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)) <span class="sc">+</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)))<span class="sc">/</span> </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"b1"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-10_a6413382b3b465bb8c13bc27afafb6b3">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) <span class="sc">+</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)))<span class="sc">/</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-11_d1d3a3c597b3cc868d9716a43c613499">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalm<span class="sc">$</span>Promedio), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="práctica-en-stan-modelo-lineal-múltiple" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-modelo-lineal-múltiple">Práctica en <strong>STAN</strong> (Modelo lineal múltiple)</h3>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-12_c2b6b3faeeec9895a77af98fccd88544">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  vector[n] y;      <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma2;  <span class="sc">/</span><span class="er">/</span> error scale</span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>transformed parameters{</span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  real<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> sigma;</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>  sigma <span class="ot">=</span> <span class="fu">sqrt</span>(sigma2);</span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>  sigma2 <span class="sc">~</span> <span class="fu">inv_gamma</span>(<span class="fl">0.0001</span>, <span class="fl">0.0001</span>);</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">normal</span>(x <span class="sc">*</span> beta, sigma);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">normal_rng</span>(x <span class="sc">*</span> beta, sigma);</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-13_fea4e02f5292b0923180b52b933b6632">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/8ModeloLm.stan")</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fitLm2 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/8ModeloLm.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-14_f1411b6c53484a76f76996842026f56d">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(Promedio <span class="sc">~</span> tiene_internet<span class="sc">+</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>                  rezago_escolar <span class="sc">+</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>                  eliminar_basura <span class="sc">+</span> </span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>                  alfabeta  , <span class="at">data =</span> datalm)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> eliminar_basura </th>
   <th style="text-align:right;"> alfabeta </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.5846 </td>
   <td style="text-align:right;"> 0.1776 </td>
   <td style="text-align:right;"> 0.1479 </td>
   <td style="text-align:right;"> 0.0662 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8879 </td>
   <td style="text-align:right;"> 0.0573 </td>
   <td style="text-align:right;"> 0.5596 </td>
   <td style="text-align:right;"> 0.1377 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.7539 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 0.1923 </td>
   <td style="text-align:right;"> 0.1023 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8763 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.5784 </td>
   <td style="text-align:right;"> 0.1628 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8798 </td>
   <td style="text-align:right;"> 0.0512 </td>
   <td style="text-align:right;"> 0.5600 </td>
   <td style="text-align:right;"> 0.1362 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9029 </td>
   <td style="text-align:right;"> 0.0524 </td>
   <td style="text-align:right;"> 0.6553 </td>
   <td style="text-align:right;"> 0.1482 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9198 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.6225 </td>
   <td style="text-align:right;"> 0.2897 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9318 </td>
   <td style="text-align:right;"> 0.0366 </td>
   <td style="text-align:right;"> 0.8980 </td>
   <td style="text-align:right;"> 0.2904 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8210 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.5401 </td>
   <td style="text-align:right;"> 0.1692 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9022 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.6333 </td>
   <td style="text-align:right;"> 0.1993 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9001 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.7537 </td>
   <td style="text-align:right;"> 0.1704 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9338 </td>
   <td style="text-align:right;"> 0.0489 </td>
   <td style="text-align:right;"> 0.8373 </td>
   <td style="text-align:right;"> 0.2222 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9168 </td>
   <td style="text-align:right;"> 0.0404 </td>
   <td style="text-align:right;"> 0.8131 </td>
   <td style="text-align:right;"> 0.3038 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9582 </td>
   <td style="text-align:right;"> 0.0277 </td>
   <td style="text-align:right;"> 0.8772 </td>
   <td style="text-align:right;"> 0.3674 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 0.0481 </td>
   <td style="text-align:right;"> 0.7979 </td>
   <td style="text-align:right;"> 0.2711 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9424 </td>
   <td style="text-align:right;"> 0.0367 </td>
   <td style="text-align:right;"> 0.8660 </td>
   <td style="text-align:right;"> 0.3490 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9083 </td>
   <td style="text-align:right;"> 0.0454 </td>
   <td style="text-align:right;"> 0.8357 </td>
   <td style="text-align:right;"> 0.2250 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8758 </td>
   <td style="text-align:right;"> 0.0431 </td>
   <td style="text-align:right;"> 0.6713 </td>
   <td style="text-align:right;"> 0.1910 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8760 </td>
   <td style="text-align:right;"> 0.0593 </td>
   <td style="text-align:right;"> 0.5707 </td>
   <td style="text-align:right;"> 0.1850 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8775 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.7061 </td>
   <td style="text-align:right;"> 0.2760 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.8985 </td>
   <td style="text-align:right;"> 0.0503 </td>
   <td style="text-align:right;"> 0.7398 </td>
   <td style="text-align:right;"> 0.2224 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.9087 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.7355 </td>
   <td style="text-align:right;"> 0.1929 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-15_213117c35cf679921df8baf7437b09cf">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalm),</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalm<span class="sc">$</span>Promedio)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-16_8e34569b17660aaafda45171f4460da5">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>model_fitLm2 <span class="ot">&lt;-</span> fitLm2<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 7.0 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 7.5 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 7.6 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 7.1 seconds.

All 4 chains finished successfully.
Mean chain execution time: 7.3 seconds.
Total execution time: 8.4 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-17_92a7c9f38f5b6daa2908bce4841d829d">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>model_fitLm2<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>,<span class="st">"sigma2"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> 10.4160 </td>
   <td style="text-align:right;"> 10.4056 </td>
   <td style="text-align:right;"> 1.9421 </td>
   <td style="text-align:right;"> 1.8727 </td>
   <td style="text-align:right;"> 7.2862 </td>
   <td style="text-align:right;"> 13.5677 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -3.3209 </td>
   <td style="text-align:right;"> -3.2925 </td>
   <td style="text-align:right;"> 2.0838 </td>
   <td style="text-align:right;"> 2.0375 </td>
   <td style="text-align:right;"> -6.7097 </td>
   <td style="text-align:right;"> 0.0189 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -2.7133 </td>
   <td style="text-align:right;"> -2.7892 </td>
   <td style="text-align:right;"> 4.2704 </td>
   <td style="text-align:right;"> 3.9839 </td>
   <td style="text-align:right;"> -9.7860 </td>
   <td style="text-align:right;"> 4.2081 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> 0.1307 </td>
   <td style="text-align:right;"> 0.1218 </td>
   <td style="text-align:right;"> 0.4953 </td>
   <td style="text-align:right;"> 0.4520 </td>
   <td style="text-align:right;"> -0.6705 </td>
   <td style="text-align:right;"> 0.9643 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -2.1549 </td>
   <td style="text-align:right;"> -2.1614 </td>
   <td style="text-align:right;"> 0.8174 </td>
   <td style="text-align:right;"> 0.7833 </td>
   <td style="text-align:right;"> -3.4562 </td>
   <td style="text-align:right;"> -0.8567 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> sigma2 </td>
   <td style="text-align:right;"> 0.0303 </td>
   <td style="text-align:right;"> 0.0273 </td>
   <td style="text-align:right;"> 0.0129 </td>
   <td style="text-align:right;"> 0.0092 </td>
   <td style="text-align:right;"> 0.0164 </td>
   <td style="text-align:right;"> 0.0532 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-18_ace6c734ef961c7c4964a7c747104029">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)) <span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)))<span class="sc">/</span> </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[1]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-19_4d37b1415dac5f2e864fbb31ef3a31ab">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)) <span class="sc">+</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)))<span class="sc">/</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[2]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-20_7a5eb07031ae511f4617d8045f58cd1b">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)) <span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)))<span class="sc">/</span> </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[3]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-21_3692f090682479477c47819642b1b5d0">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)) <span class="sc">+</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)))<span class="sc">/</span> </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta[4]"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-22_8acf2c2b0a68bbfff2516ff097d801b6">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(<span class="fu">mcmc_hist_by_chain</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) <span class="sc">+</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)))<span class="sc">/</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_fitLm1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"sigma2"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-23_0e46bf49ca766016a0339386e07458e9">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_fitLm2<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom,]</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalm<span class="sc">$</span>Promedio), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modelo-bernoulli-con-vínculo-logístico" class="level2">
<h2 class="anchored" data-anchor-id="modelo-bernoulli-con-vínculo-logístico">Modelo Bernoulli con vínculo logístico</h2>
<p>Este caso es típico en donde la variable respuesta sólo toma dos valores, uno en caso de un evento exitoso y cero, cuando se presenta un fracaso. Se supone que <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> es un conjunto de variables aleatorias intercambiables cada una con distribución bernoulli de parámetro <span class="math inline">\(\theta_i\)</span>, y se quiere estudiar la relación entre <span class="math inline">\(\theta_i\)</span> y las variables auxiliares <span class="math inline">\(\mathbf{X}_i\)</span> por medio de la función de enlace <span class="math inline">\(g(\theta_i)=\mathbf{X}_i'\boldsymbol{\beta}\)</span>. Aquí consideramos la función de enlace logística</p>
<p><span class="math display">\[
\begin{equation}
\eta_i=g(\theta_i)=logit(\theta_i)=\log\left(\frac{\theta_i}{1-\theta_i}\right)
\end{equation}
\]</span></p>
<p>fácilmente se encuentra que la función inversa para <span class="math inline">\(g(\cdot)\)</span>, está dada por</p>
<p><span class="math display">\[
\begin{equation*}
\theta_i=g^{-1}(\eta_i)=\frac{\exp(\eta_i)}{1+\exp(\eta_i)}
\end{equation*}
\]</span></p>
<p>Notando que <span class="math inline">\(\eta_i=\mathbf{X}_i'\boldsymbol{\beta}\)</span> y siguiendo con el modelamiento, se tiene que la verosimilitud de los datos está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\mathbf{Y}\mid \boldsymbol{\theta})&amp;=\prod_{i=1}^n\theta_i^{y_i}(1-\theta_i)^{1-y_i} \notag \\
p(\mathbf{Y}\mid \boldsymbol{\beta})&amp;=\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{1-y_i}
\end{align}
\]</span></p>
<p>Suponga que la distribución a previa para <span class="math inline">\(\boldsymbol{\beta}\)</span> está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}\sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span></p>
<p>De esta manera, la distribución a posterior toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta} \mid \mathbf{Y}, \mathbf{X})&amp;\propto
\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{1-y_i}\\
&amp;\hspace{2cm}\times
\exp\left\{\frac{-1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>La anterior expresión no tiene una forma cerrada y no es sencillo, en primera instancia, simular observaciones u obtener inferencias a posterior.</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-24_ffdc9a97e1a7fa835ada20fb993b6e72">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>datalogit <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">dam =</span> <span class="fu">str_pad</span>(dam_ee, <span class="at">pad =</span> <span class="st">"0"</span>, <span class="at">width =</span> <span class="dv">2</span>), </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">pobreza =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">sexo =</span> <span class="fu">as_factor</span>(sexo),  </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">anoest =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">5</span> <span class="sc">|</span> <span class="fu">is.na</span>(anoest)   <span class="sc">~</span> <span class="st">"98"</span>  , <span class="co">#No aplica</span></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">==</span> <span class="dv">99</span> <span class="sc">~</span> <span class="st">"99"</span>, <span class="co">#NS/NR</span></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">==</span> <span class="dv">0</span>  <span class="sc">~</span> <span class="st">"1"</span>, <span class="co"># Sin educacion</span></span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>) <span class="sc">~</span> <span class="st">"2"</span>,       <span class="co"># 1 - 6</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">12</span>) <span class="sc">~</span> <span class="st">"3"</span>,      <span class="co"># 7 - 12</span></span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    anoest <span class="sc">&gt;</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"4"</span> ),</span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="at">edad =</span> <span class="fu">case_when</span>(</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">15</span> <span class="sc">~</span> <span class="st">"1"</span>,</span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">30</span> <span class="sc">~</span> <span class="st">"2"</span>,</span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">45</span> <span class="sc">~</span> <span class="st">"3"</span>,</span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>    edad <span class="sc">&lt;</span> <span class="dv">65</span> <span class="sc">~</span> <span class="st">"4"</span>,</span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"5"</span>),</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">%&gt;%</span> </span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(dam <span class="sc">==</span><span class="st">"02"</span>, anoest <span class="sc">%in%</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>))</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(datalogit, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> dam </th>
   <th style="text-align:right;"> pobreza </th>
   <th style="text-align:left;"> sexo </th>
   <th style="text-align:left;"> anoest </th>
   <th style="text-align:left;"> edad </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 3 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 4 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Hombre </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 1 </td>
   <td style="text-align:left;"> 5 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 3 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 4 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:left;"> Mujer </td>
   <td style="text-align:left;"> 2 </td>
   <td style="text-align:left;"> 2 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<section id="práctica-en-stan" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan">Práctica en <strong>STAN</strong></h3>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-25_a369c1c8b738884750538175038bf212">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  int y;      <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    vector[n] inv_eta;</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>   inv_eta <span class="ot">=</span> <span class="fu">inv_logit</span>(x <span class="sc">*</span> beta);</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">bernoulli</span>(inv_eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">bernoulli_rng</span>(inv_eta);</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-26_df8f8ba9855520723e9a3802ca44796d">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/9ModeloLogit.stan")</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>fitLosgit1 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/9ModeloLogit.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-27_7f8d08ef383e09f5dccb592b574e02c7">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(pobreza <span class="sc">~</span> sexo <span class="sc">+</span> anoest <span class="sc">+</span> edad,</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> datalogit)</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(Xdat, <span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> sexoMujer </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
   <td style="text-align:right;"> 0 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-28_e220451bbf1072b2050ce9182fbecb24">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">n =</span> <span class="fu">nrow</span>(datalogit),</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> datalogit<span class="sc">$</span>pobreza)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-29_795821f71293e62e93884f4091eed955">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>model_Losgit1 <span class="ot">&lt;-</span> fitLosgit1<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 22.4 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 23.5 seconds.
Chain 4 finished in 22.8 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 23.6 seconds.

All 4 chains finished successfully.
Mean chain execution time: 23.1 seconds.
Total execution time: 24.3 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-30_ba6151ccbc66f29916ff30aba874eab8">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>model_Losgit1<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> 0.9478 </td>
   <td style="text-align:right;"> 0.9477 </td>
   <td style="text-align:right;"> 0.2266 </td>
   <td style="text-align:right;"> 0.2187 </td>
   <td style="text-align:right;"> 0.5742 </td>
   <td style="text-align:right;"> 1.3197 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -0.0263 </td>
   <td style="text-align:right;"> -0.0248 </td>
   <td style="text-align:right;"> 0.1300 </td>
   <td style="text-align:right;"> 0.1293 </td>
   <td style="text-align:right;"> -0.2367 </td>
   <td style="text-align:right;"> 0.1873 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -0.5038 </td>
   <td style="text-align:right;"> -0.5050 </td>
   <td style="text-align:right;"> 0.1807 </td>
   <td style="text-align:right;"> 0.1817 </td>
   <td style="text-align:right;"> -0.7980 </td>
   <td style="text-align:right;"> -0.2093 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -2.0864 </td>
   <td style="text-align:right;"> -2.0837 </td>
   <td style="text-align:right;"> 0.2251 </td>
   <td style="text-align:right;"> 0.2208 </td>
   <td style="text-align:right;"> -2.4615 </td>
   <td style="text-align:right;"> -1.7140 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -4.9040 </td>
   <td style="text-align:right;"> -4.7194 </td>
   <td style="text-align:right;"> 1.3110 </td>
   <td style="text-align:right;"> 1.2071 </td>
   <td style="text-align:right;"> -7.4312 </td>
   <td style="text-align:right;"> -3.1511 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> -0.0371 </td>
   <td style="text-align:right;"> -0.0357 </td>
   <td style="text-align:right;"> 0.1676 </td>
   <td style="text-align:right;"> 0.1650 </td>
   <td style="text-align:right;"> -0.3127 </td>
   <td style="text-align:right;"> 0.2352 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.7652 </td>
   <td style="text-align:right;"> -0.7641 </td>
   <td style="text-align:right;"> 0.1929 </td>
   <td style="text-align:right;"> 0.1911 </td>
   <td style="text-align:right;"> -1.0843 </td>
   <td style="text-align:right;"> -0.4495 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> -0.9653 </td>
   <td style="text-align:right;"> -0.9610 </td>
   <td style="text-align:right;"> 0.2353 </td>
   <td style="text-align:right;"> 0.2321 </td>
   <td style="text-align:right;"> -1.3580 </td>
   <td style="text-align:right;"> -0.5761 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-31_cb6469efe411ad8d663d67cd4a863291">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-32_e63265b19bce297b47d1ff17d91cabd1">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-33_b476a69c87fdda14c771bbb3807b790e">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Losgit1<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalogit<span class="sc">$</span>pobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Una alternativa es hacer el siguiente modelo que utiliza la función <code>bernoulli_logit</code></p>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-34_3b6848fdee5ec541d4df5849e7ba085d">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> n;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  matrix[n, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span>,upper<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> y[n];       <span class="sc">/</span><span class="er">/</span> Vector respuesta</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a> }</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>   vector[n] eta;</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>   eta <span class="ot">=</span> x <span class="sc">*</span> beta;</span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>  y <span class="sc">~</span> <span class="fu">bernoulli_logit</span>(eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>    real ypred[n];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>    ypred <span class="ot">=</span> <span class="fu">bernoulli_logit_rng</span>(eta);</span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-35_76e212627b13f31c1acb656151949dd1">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/10ModeloLogit.stan")</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>fitLosgit2 <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/10ModeloLogit.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-36_27fc2968f35e40888121846ca7900d09">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>model_Losgit2 <span class="ot">&lt;-</span> fitLosgit2<span class="sc">$</span><span class="fu">sample</span>(<span class="at">data =</span> sample_data, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 13.8 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 14.0 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 13.3 seconds.
Chain 3 finished in 13.9 seconds.

All 4 chains finished successfully.
Mean chain execution time: 13.7 seconds.
Total execution time: 14.8 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-37_db028a11c381c90e626a1f1a4a473ef3">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>model_Losgit2<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> 0.9659 </td>
   <td style="text-align:right;"> 0.9693 </td>
   <td style="text-align:right;"> 0.2277 </td>
   <td style="text-align:right;"> 0.2272 </td>
   <td style="text-align:right;"> 0.5898 </td>
   <td style="text-align:right;"> 1.3411 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -0.0300 </td>
   <td style="text-align:right;"> -0.0304 </td>
   <td style="text-align:right;"> 0.1279 </td>
   <td style="text-align:right;"> 0.1273 </td>
   <td style="text-align:right;"> -0.2384 </td>
   <td style="text-align:right;"> 0.1765 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> -0.5136 </td>
   <td style="text-align:right;"> -0.5164 </td>
   <td style="text-align:right;"> 0.1778 </td>
   <td style="text-align:right;"> 0.1748 </td>
   <td style="text-align:right;"> -0.8043 </td>
   <td style="text-align:right;"> -0.2169 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> -2.1007 </td>
   <td style="text-align:right;"> -2.0975 </td>
   <td style="text-align:right;"> 0.2252 </td>
   <td style="text-align:right;"> 0.2237 </td>
   <td style="text-align:right;"> -2.4767 </td>
   <td style="text-align:right;"> -1.7344 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> -4.9116 </td>
   <td style="text-align:right;"> -4.7173 </td>
   <td style="text-align:right;"> 1.3020 </td>
   <td style="text-align:right;"> 1.1636 </td>
   <td style="text-align:right;"> -7.3476 </td>
   <td style="text-align:right;"> -3.2146 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> -0.0449 </td>
   <td style="text-align:right;"> -0.0462 </td>
   <td style="text-align:right;"> 0.1678 </td>
   <td style="text-align:right;"> 0.1704 </td>
   <td style="text-align:right;"> -0.3192 </td>
   <td style="text-align:right;"> 0.2346 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.7771 </td>
   <td style="text-align:right;"> -0.7772 </td>
   <td style="text-align:right;"> 0.1948 </td>
   <td style="text-align:right;"> 0.1946 </td>
   <td style="text-align:right;"> -1.0991 </td>
   <td style="text-align:right;"> -0.4527 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> -0.9806 </td>
   <td style="text-align:right;"> -0.9755 </td>
   <td style="text-align:right;"> 0.2431 </td>
   <td style="text-align:right;"> 0.2466 </td>
   <td style="text-align:right;"> -1.3824 </td>
   <td style="text-align:right;"> -0.5866 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-38_83ecd600ff9e048edc67a79ac8e401af">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-39_31e7a74bd5f5dbee036342ec8edf3a8c">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-40_acb961cb2c5cce1c2757f04ce5d5cfc5">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Losgit2<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(datalogit<span class="sc">$</span>pobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="modelo-binomial" class="level2">
<h2 class="anchored" data-anchor-id="modelo-binomial">Modelo Binomial</h2>
<p>En este caso la variable respuesta representa conteos de éxitos que se tuvieron en un conjunto de distintos experimentos. Se supone que <span class="math inline">\(\mathbf{Y}=\{Y_1, \ldots, Y_n\}\)</span> es un conjunto de variables aleatorias intercambiables cada una con distribución binomial de parámetro <span class="math inline">\(\theta_i\)</span> y <span class="math inline">\(n_i\)</span>. El modelo binomial busca relacionar las probabilidades de éxito <span class="math inline">\(\theta_i\)</span> con variables auxiliares <span class="math inline">\(\mathbf{X}_i\)</span>. Se considera a continuación la función de enlace logística.</p>
<p>La función de vínculo logística dada por <span class="math inline">\(g(\theta_i)=\log\left(\frac{\theta_i}{1-\theta_i}\right)\)</span>, y denotando <span class="math inline">\(\eta_i=\mathbf{X}_i'\boldsymbol{\beta}=g(\theta_i)\)</span>, se tiene que la verosimilitud de los datos está dada por</p>
<p><span class="math display">\[
\begin{align}
p(\mathbf{Y}\mid \boldsymbol{\theta})&amp;=\prod_{i=1}^n\binom{n}{y_i}\theta_i^{y_i}(1-\theta_i)^{n-y_i} \notag \\
&amp;=\prod_{i=1}^n\binom{n}{y_i}\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{n-y_i}
\end{align}
\]</span> Suponga que la distribución a previa para <span class="math inline">\(\boldsymbol{\beta}\)</span> está regida por la siguiente estructura probabilística</p>
<p><span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}\sim N_q(\mathbf{b},\mathbf{B})
\end{equation*}
\]</span> De esta manera, la distribución a posterior toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta} \mid \mathbf{Y}, \mathbf{X})&amp;\propto
\prod_{i=1}^n\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)^{y_i}
\left(1-\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta})}{1+\exp(\mathbf{X}_i'\boldsymbol{\beta})}\right)\right)^{n-y_i}\\
&amp;\hspace{2cm}\times
\exp\left\{\frac{-1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>Una vez más, la anterior expresión no tiene una forma cerrada.</p>
<section id="práctica-en-stan-1" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-1">Práctica en <code>STAN</code></h3>
<p>Datos de la encuesta</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-41_3a95303e443d9b0eeea6481a0462cf9e">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>dataBino <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span> </span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">dam =</span> <span class="fu">str_pad</span>(dam_ee, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">pobreza =</span> <span class="fu">ifelse</span>(ingcorte <span class="sc">&lt;</span> lp, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dam) <span class="sc">%&gt;%</span> </span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(</span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">n =</span> <span class="fu">n</span>() ,                  <span class="co"># Número de ensayos</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">nPobreza =</span> <span class="fu">sum</span>(pobreza)    <span class="co"># número de exitos </span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span>                      <span class="co"># covariables  </span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">full_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"dam"</span>) </span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(<span class="fu">head</span>(dataBino,<span class="dv">10</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> dam </th>
   <th style="text-align:right;"> n </th>
   <th style="text-align:right;"> nPobreza </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivos </th>
   <th style="text-align:right;"> suelo_urbanos </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> eliminar_basura </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> hacinamiento </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 2671 </td>
   <td style="text-align:right;"> 400 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 25.4075 </td>
   <td style="text-align:right;"> 12.3671 </td>
   <td style="text-align:right;"> 13.5749 </td>
   <td style="text-align:right;"> 0.9124 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.5193 </td>
   <td style="text-align:right;"> 0.2915 </td>
   <td style="text-align:right;"> 0.2128 </td>
   <td style="text-align:right;"> 0.1624 </td>
   <td style="text-align:right;"> 0.0657 </td>
   <td style="text-align:right;"> 0.3094 </td>
   <td style="text-align:right;"> 0.3764 </td>
   <td style="text-align:right;"> 0.1137 </td>
   <td style="text-align:right;"> 0.1346 </td>
   <td style="text-align:right;"> 0.2125 </td>
   <td style="text-align:right;"> 0.0089 </td>
   <td style="text-align:right;"> 0.0963 </td>
   <td style="text-align:right;"> 0.1474 </td>
   <td style="text-align:right;"> 0.1479 </td>
   <td style="text-align:right;"> 0.5846 </td>
   <td style="text-align:right;"> 0.0561 </td>
   <td style="text-align:right;"> 0.0979 </td>
   <td style="text-align:right;"> 0.0228 </td>
   <td style="text-align:right;"> 0.1776 </td>
   <td style="text-align:right;"> 0.0662 </td>
   <td style="text-align:right;"> 0.3385 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 1141 </td>
   <td style="text-align:right;"> 490 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 3.0275 </td>
   <td style="text-align:right;"> 25.3519 </td>
   <td style="text-align:right;"> 0.9920 </td>
   <td style="text-align:right;"> 0.5176 </td>
   <td style="text-align:right;"> 0.0015 </td>
   <td style="text-align:right;"> 0.5065 </td>
   <td style="text-align:right;"> 0.2867 </td>
   <td style="text-align:right;"> 0.1893 </td>
   <td style="text-align:right;"> 0.1490 </td>
   <td style="text-align:right;"> 0.0696 </td>
   <td style="text-align:right;"> 0.4022 </td>
   <td style="text-align:right;"> 0.2926 </td>
   <td style="text-align:right;"> 0.0350 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 0.6296 </td>
   <td style="text-align:right;"> 0.0629 </td>
   <td style="text-align:right;"> 0.1756 </td>
   <td style="text-align:right;"> 0.4667 </td>
   <td style="text-align:right;"> 0.5596 </td>
   <td style="text-align:right;"> 0.8879 </td>
   <td style="text-align:right;"> 0.1277 </td>
   <td style="text-align:right;"> 0.0776 </td>
   <td style="text-align:right;"> 0.0270 </td>
   <td style="text-align:right;"> 0.0573 </td>
   <td style="text-align:right;"> 0.1377 </td>
   <td style="text-align:right;"> 0.4128 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 2267 </td>
   <td style="text-align:right;"> 576 </td>
   <td style="text-align:right;"> 0.0230 </td>
   <td style="text-align:right;"> 19.9710 </td>
   <td style="text-align:right;"> 9.2249 </td>
   <td style="text-align:right;"> 7.4542 </td>
   <td style="text-align:right;"> 0.8847 </td>
   <td style="text-align:right;"> 0.0028 </td>
   <td style="text-align:right;"> 0.5107 </td>
   <td style="text-align:right;"> 0.3031 </td>
   <td style="text-align:right;"> 0.2042 </td>
   <td style="text-align:right;"> 0.1447 </td>
   <td style="text-align:right;"> 0.0602 </td>
   <td style="text-align:right;"> 0.3918 </td>
   <td style="text-align:right;"> 0.3123 </td>
   <td style="text-align:right;"> 0.0665 </td>
   <td style="text-align:right;"> 0.4024 </td>
   <td style="text-align:right;"> 0.1464 </td>
   <td style="text-align:right;"> 0.0110 </td>
   <td style="text-align:right;"> 0.0725 </td>
   <td style="text-align:right;"> 0.3270 </td>
   <td style="text-align:right;"> 0.1923 </td>
   <td style="text-align:right;"> 0.7539 </td>
   <td style="text-align:right;"> 0.1173 </td>
   <td style="text-align:right;"> 0.1291 </td>
   <td style="text-align:right;"> 0.0266 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 0.1023 </td>
   <td style="text-align:right;"> 0.3886 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 1370 </td>
   <td style="text-align:right;"> 782 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 7.0750 </td>
   <td style="text-align:right;"> 11.8985 </td>
   <td style="text-align:right;"> 3.1658 </td>
   <td style="text-align:right;"> 0.5413 </td>
   <td style="text-align:right;"> 0.0030 </td>
   <td style="text-align:right;"> 0.5174 </td>
   <td style="text-align:right;"> 0.3069 </td>
   <td style="text-align:right;"> 0.1789 </td>
   <td style="text-align:right;"> 0.1245 </td>
   <td style="text-align:right;"> 0.0495 </td>
   <td style="text-align:right;"> 0.4451 </td>
   <td style="text-align:right;"> 0.2361 </td>
   <td style="text-align:right;"> 0.0289 </td>
   <td style="text-align:right;"> 0.7821 </td>
   <td style="text-align:right;"> 0.4722 </td>
   <td style="text-align:right;"> 0.0382 </td>
   <td style="text-align:right;"> 0.2644 </td>
   <td style="text-align:right;"> 0.6590 </td>
   <td style="text-align:right;"> 0.5784 </td>
   <td style="text-align:right;"> 0.8763 </td>
   <td style="text-align:right;"> 0.1530 </td>
   <td style="text-align:right;"> 0.0824 </td>
   <td style="text-align:right;"> 0.0064 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.1628 </td>
   <td style="text-align:right;"> 0.5231 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 1770 </td>
   <td style="text-align:right;"> 503 </td>
   <td style="text-align:right;"> 0.0525 </td>
   <td style="text-align:right;"> 7.1401 </td>
   <td style="text-align:right;"> 35.2899 </td>
   <td style="text-align:right;"> 2.2458 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.0033 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.3015 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.1375 </td>
   <td style="text-align:right;"> 0.0545 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.2994 </td>
   <td style="text-align:right;"> 0.0309 </td>
   <td style="text-align:right;"> 0.0510 </td>
   <td style="text-align:right;"> 0.5050 </td>
   <td style="text-align:right;"> 0.0324 </td>
   <td style="text-align:right;"> 0.4462 </td>
   <td style="text-align:right;"> 0.3742 </td>
   <td style="text-align:right;"> 0.5600 </td>
   <td style="text-align:right;"> 0.8798 </td>
   <td style="text-align:right;"> 0.1202 </td>
   <td style="text-align:right;"> 0.1214 </td>
   <td style="text-align:right;"> 0.0307 </td>
   <td style="text-align:right;"> 0.0512 </td>
   <td style="text-align:right;"> 0.1362 </td>
   <td style="text-align:right;"> 0.5027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 977 </td>
   <td style="text-align:right;"> 475 </td>
   <td style="text-align:right;"> 0.0305 </td>
   <td style="text-align:right;"> 3.2267 </td>
   <td style="text-align:right;"> 26.5864 </td>
   <td style="text-align:right;"> 0.8061 </td>
   <td style="text-align:right;"> 0.4645 </td>
   <td style="text-align:right;"> 0.0039 </td>
   <td style="text-align:right;"> 0.5069 </td>
   <td style="text-align:right;"> 0.2929 </td>
   <td style="text-align:right;"> 0.1801 </td>
   <td style="text-align:right;"> 0.1433 </td>
   <td style="text-align:right;"> 0.0650 </td>
   <td style="text-align:right;"> 0.4243 </td>
   <td style="text-align:right;"> 0.2587 </td>
   <td style="text-align:right;"> 0.0311 </td>
   <td style="text-align:right;"> 0.1607 </td>
   <td style="text-align:right;"> 0.7005 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.2722 </td>
   <td style="text-align:right;"> 0.5872 </td>
   <td style="text-align:right;"> 0.6553 </td>
   <td style="text-align:right;"> 0.9029 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.0865 </td>
   <td style="text-align:right;"> 0.0379 </td>
   <td style="text-align:right;"> 0.0524 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.4720 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 1230 </td>
   <td style="text-align:right;"> 736 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 7.2985 </td>
   <td style="text-align:right;"> 8.7206 </td>
   <td style="text-align:right;"> 3.7948 </td>
   <td style="text-align:right;"> 0.6156 </td>
   <td style="text-align:right;"> 0.0018 </td>
   <td style="text-align:right;"> 0.5226 </td>
   <td style="text-align:right;"> 0.3085 </td>
   <td style="text-align:right;"> 0.1840 </td>
   <td style="text-align:right;"> 0.1261 </td>
   <td style="text-align:right;"> 0.0511 </td>
   <td style="text-align:right;"> 0.3822 </td>
   <td style="text-align:right;"> 0.2154 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.9638 </td>
   <td style="text-align:right;"> 0.7169 </td>
   <td style="text-align:right;"> 0.0485 </td>
   <td style="text-align:right;"> 0.0690 </td>
   <td style="text-align:right;"> 0.8503 </td>
   <td style="text-align:right;"> 0.6225 </td>
   <td style="text-align:right;"> 0.9198 </td>
   <td style="text-align:right;"> 0.1591 </td>
   <td style="text-align:right;"> 0.0482 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.2897 </td>
   <td style="text-align:right;"> 0.5434 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 1245 </td>
   <td style="text-align:right;"> 700 </td>
   <td style="text-align:right;"> 0.0161 </td>
   <td style="text-align:right;"> 8.5521 </td>
   <td style="text-align:right;"> 11.9767 </td>
   <td style="text-align:right;"> 5.8417 </td>
   <td style="text-align:right;"> 0.4896 </td>
   <td style="text-align:right;"> 0.0016 </td>
   <td style="text-align:right;"> 0.5310 </td>
   <td style="text-align:right;"> 0.3064 </td>
   <td style="text-align:right;"> 0.1627 </td>
   <td style="text-align:right;"> 0.1298 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.4401 </td>
   <td style="text-align:right;"> 0.1702 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 0.9801 </td>
   <td style="text-align:right;"> 0.7864 </td>
   <td style="text-align:right;"> 0.0513 </td>
   <td style="text-align:right;"> 0.3053 </td>
   <td style="text-align:right;"> 0.8603 </td>
   <td style="text-align:right;"> 0.8980 </td>
   <td style="text-align:right;"> 0.9318 </td>
   <td style="text-align:right;"> 0.2931 </td>
   <td style="text-align:right;"> 0.0102 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.0366 </td>
   <td style="text-align:right;"> 0.2904 </td>
   <td style="text-align:right;"> 0.6049 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 1831 </td>
   <td style="text-align:right;"> 902 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 9.4656 </td>
   <td style="text-align:right;"> 18.2660 </td>
   <td style="text-align:right;"> 6.0706 </td>
   <td style="text-align:right;"> 0.6155 </td>
   <td style="text-align:right;"> 0.0023 </td>
   <td style="text-align:right;"> 0.5272 </td>
   <td style="text-align:right;"> 0.3001 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> 0.1431 </td>
   <td style="text-align:right;"> 0.0627 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2586 </td>
   <td style="text-align:right;"> 0.0669 </td>
   <td style="text-align:right;"> 0.5089 </td>
   <td style="text-align:right;"> 0.4037 </td>
   <td style="text-align:right;"> 0.0394 </td>
   <td style="text-align:right;"> 0.2054 </td>
   <td style="text-align:right;"> 0.5427 </td>
   <td style="text-align:right;"> 0.5401 </td>
   <td style="text-align:right;"> 0.8210 </td>
   <td style="text-align:right;"> 0.0990 </td>
   <td style="text-align:right;"> 0.0321 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.1692 </td>
   <td style="text-align:right;"> 0.4582 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 1573 </td>
   <td style="text-align:right;"> 642 </td>
   <td style="text-align:right;"> 0.0338 </td>
   <td style="text-align:right;"> 5.1872 </td>
   <td style="text-align:right;"> 29.3599 </td>
   <td style="text-align:right;"> 1.6822 </td>
   <td style="text-align:right;"> 0.4799 </td>
   <td style="text-align:right;"> 0.0075 </td>
   <td style="text-align:right;"> 0.5091 </td>
   <td style="text-align:right;"> 0.2985 </td>
   <td style="text-align:right;"> 0.1764 </td>
   <td style="text-align:right;"> 0.1278 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.4026 </td>
   <td style="text-align:right;"> 0.2424 </td>
   <td style="text-align:right;"> 0.0285 </td>
   <td style="text-align:right;"> 0.3810 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.0606 </td>
   <td style="text-align:right;"> 0.3155 </td>
   <td style="text-align:right;"> 0.6388 </td>
   <td style="text-align:right;"> 0.6333 </td>
   <td style="text-align:right;"> 0.9022 </td>
   <td style="text-align:right;"> 0.1896 </td>
   <td style="text-align:right;"> 0.0949 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.1993 </td>
   <td style="text-align:right;"> 0.5800 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-42_fd5e77050af67e4b7637dd5fec6d2a5b">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> D;   <span class="sc">/</span><span class="er">/</span> Número de observaciones</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> K;   <span class="sc">/</span><span class="er">/</span> Número de predictores</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> nd[D];  <span class="sc">/</span><span class="er">/</span> Número de ensayos</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">0</span><span class="sc">&gt;</span> yd[D];   <span class="sc">/</span><span class="er">/</span> Número de exitos</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  matrix[D, K] x;   <span class="sc">/</span><span class="er">/</span> Matrix de predictores</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>  vector[K] beta;       <span class="sc">/</span><span class="er">/</span> coefficients <span class="cf">for</span> predictors</span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>   vector[D] eta;</span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a>   eta <span class="ot">=</span>  x <span class="sc">*</span> beta;</span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a>   }</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">10000</span>);</span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a>  yd <span class="sc">~</span> <span class="fu">binomial_logit</span>(nd, eta);  <span class="sc">/</span><span class="er">/</span> likelihood</span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a>    real ypred[D];                    <span class="sc">/</span><span class="er">/</span> vector de longitud n</span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a>  ypred <span class="ot">=</span> <span class="fu">binomial_rng</span>(nd, <span class="fu">inv_logit</span>(eta));  </span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-43_2364ba6328b34e96d0f688bde45e0e71">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/11ModeloBinomial.stan")</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>fitBinomial <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/11ModeloBinomial.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-44_da713c550c7450eb252de38d258fcd69">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(nPobreza <span class="sc">~</span>  material_paredes <span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>                      alfabeta <span class="sc">+</span>  tiene_internet <span class="sc">+</span> </span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>                      piso_tierra <span class="sc">+</span> piso_tierra <span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>                       rezago_escolar  <span class="sc">+</span> tiene_alcantarillado <span class="sc">+</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>                       tiene_electricidad ,</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">data =</span> dataBino)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0979 </td>
   <td style="text-align:right;"> 0.0662 </td>
   <td style="text-align:right;"> 0.5846 </td>
   <td style="text-align:right;"> 0.0561 </td>
   <td style="text-align:right;"> 0.1776 </td>
   <td style="text-align:right;"> 0.2125 </td>
   <td style="text-align:right;"> 0.0089 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0776 </td>
   <td style="text-align:right;"> 0.1377 </td>
   <td style="text-align:right;"> 0.8879 </td>
   <td style="text-align:right;"> 0.1277 </td>
   <td style="text-align:right;"> 0.0573 </td>
   <td style="text-align:right;"> 0.6296 </td>
   <td style="text-align:right;"> 0.0629 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.1291 </td>
   <td style="text-align:right;"> 0.1023 </td>
   <td style="text-align:right;"> 0.7539 </td>
   <td style="text-align:right;"> 0.1173 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 0.1464 </td>
   <td style="text-align:right;"> 0.0110 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0824 </td>
   <td style="text-align:right;"> 0.1628 </td>
   <td style="text-align:right;"> 0.8763 </td>
   <td style="text-align:right;"> 0.1530 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.4722 </td>
   <td style="text-align:right;"> 0.0382 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.1214 </td>
   <td style="text-align:right;"> 0.1362 </td>
   <td style="text-align:right;"> 0.8798 </td>
   <td style="text-align:right;"> 0.1202 </td>
   <td style="text-align:right;"> 0.0512 </td>
   <td style="text-align:right;"> 0.5050 </td>
   <td style="text-align:right;"> 0.0324 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0865 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.9029 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.0524 </td>
   <td style="text-align:right;"> 0.7005 </td>
   <td style="text-align:right;"> 0.0741 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0482 </td>
   <td style="text-align:right;"> 0.2897 </td>
   <td style="text-align:right;"> 0.9198 </td>
   <td style="text-align:right;"> 0.1591 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.7169 </td>
   <td style="text-align:right;"> 0.0485 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0102 </td>
   <td style="text-align:right;"> 0.2904 </td>
   <td style="text-align:right;"> 0.9318 </td>
   <td style="text-align:right;"> 0.2931 </td>
   <td style="text-align:right;"> 0.0366 </td>
   <td style="text-align:right;"> 0.7864 </td>
   <td style="text-align:right;"> 0.0513 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0321 </td>
   <td style="text-align:right;"> 0.1692 </td>
   <td style="text-align:right;"> 0.8210 </td>
   <td style="text-align:right;"> 0.0990 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.4037 </td>
   <td style="text-align:right;"> 0.0394 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0949 </td>
   <td style="text-align:right;"> 0.1993 </td>
   <td style="text-align:right;"> 0.9022 </td>
   <td style="text-align:right;"> 0.1896 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.0606 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0750 </td>
   <td style="text-align:right;"> 0.1704 </td>
   <td style="text-align:right;"> 0.9001 </td>
   <td style="text-align:right;"> 0.2132 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.6088 </td>
   <td style="text-align:right;"> 0.0596 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0333 </td>
   <td style="text-align:right;"> 0.2222 </td>
   <td style="text-align:right;"> 0.9338 </td>
   <td style="text-align:right;"> 0.2352 </td>
   <td style="text-align:right;"> 0.0489 </td>
   <td style="text-align:right;"> 0.7269 </td>
   <td style="text-align:right;"> 0.0783 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0251 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.9168 </td>
   <td style="text-align:right;"> 0.3014 </td>
   <td style="text-align:right;"> 0.0404 </td>
   <td style="text-align:right;"> 0.6501 </td>
   <td style="text-align:right;"> 0.1352 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0223 </td>
   <td style="text-align:right;"> 0.3674 </td>
   <td style="text-align:right;"> 0.9582 </td>
   <td style="text-align:right;"> 0.3939 </td>
   <td style="text-align:right;"> 0.0277 </td>
   <td style="text-align:right;"> 0.7871 </td>
   <td style="text-align:right;"> 0.1401 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.2711 </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 0.2960 </td>
   <td style="text-align:right;"> 0.0481 </td>
   <td style="text-align:right;"> 0.7507 </td>
   <td style="text-align:right;"> 0.1587 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.1333 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.9424 </td>
   <td style="text-align:right;"> 0.5713 </td>
   <td style="text-align:right;"> 0.0367 </td>
   <td style="text-align:right;"> 0.8622 </td>
   <td style="text-align:right;"> 0.3541 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0450 </td>
   <td style="text-align:right;"> 0.2250 </td>
   <td style="text-align:right;"> 0.9083 </td>
   <td style="text-align:right;"> 0.3225 </td>
   <td style="text-align:right;"> 0.0454 </td>
   <td style="text-align:right;"> 0.9454 </td>
   <td style="text-align:right;"> 0.1586 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0885 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.8758 </td>
   <td style="text-align:right;"> 0.2242 </td>
   <td style="text-align:right;"> 0.0431 </td>
   <td style="text-align:right;"> 0.7144 </td>
   <td style="text-align:right;"> 0.1412 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.1781 </td>
   <td style="text-align:right;"> 0.1850 </td>
   <td style="text-align:right;"> 0.8760 </td>
   <td style="text-align:right;"> 0.1602 </td>
   <td style="text-align:right;"> 0.0593 </td>
   <td style="text-align:right;"> 0.5975 </td>
   <td style="text-align:right;"> 0.0908 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.2379 </td>
   <td style="text-align:right;"> 0.2760 </td>
   <td style="text-align:right;"> 0.8775 </td>
   <td style="text-align:right;"> 0.3376 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.7037 </td>
   <td style="text-align:right;"> 0.1674 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0427 </td>
   <td style="text-align:right;"> 0.2224 </td>
   <td style="text-align:right;"> 0.8985 </td>
   <td style="text-align:right;"> 0.3761 </td>
   <td style="text-align:right;"> 0.0503 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.1146 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0607 </td>
   <td style="text-align:right;"> 0.1929 </td>
   <td style="text-align:right;"> 0.9087 </td>
   <td style="text-align:right;"> 0.1964 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.0774 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-45_82a85d2e1297ed0ae958cae2195f8f53">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">D =</span> <span class="fu">nrow</span>(dataBino),</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">x =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">yd =</span> dataBino<span class="sc">$</span>nPobreza,</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">nd =</span> dataBino<span class="sc">$</span>n)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-46_e88cab24ccc2a7471e99a516ee7dfc37">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>model_Binomial <span class="ot">&lt;-</span> fitBinomial<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sample_data, </span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 13.4 seconds.
Chain 3 finished in 13.3 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 14.0 seconds.
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 14.0 seconds.

All 4 chains finished successfully.
Mean chain execution time: 13.7 seconds.
Total execution time: 14.9 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-47_33776cd103576ae7ffeebe66bbaf3806">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>model_Binomial<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1] </td>
   <td style="text-align:right;"> -8.2333 </td>
   <td style="text-align:right;"> -8.2302 </td>
   <td style="text-align:right;"> 0.6933 </td>
   <td style="text-align:right;"> 0.7077 </td>
   <td style="text-align:right;"> -9.3736 </td>
   <td style="text-align:right;"> -7.1107 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2] </td>
   <td style="text-align:right;"> -2.8155 </td>
   <td style="text-align:right;"> -2.8125 </td>
   <td style="text-align:right;"> 0.3627 </td>
   <td style="text-align:right;"> 0.3562 </td>
   <td style="text-align:right;"> -3.4208 </td>
   <td style="text-align:right;"> -2.2153 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[3] </td>
   <td style="text-align:right;"> 3.2496 </td>
   <td style="text-align:right;"> 3.2481 </td>
   <td style="text-align:right;"> 0.3475 </td>
   <td style="text-align:right;"> 0.3432 </td>
   <td style="text-align:right;"> 2.6647 </td>
   <td style="text-align:right;"> 3.8176 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[4] </td>
   <td style="text-align:right;"> 8.0872 </td>
   <td style="text-align:right;"> 8.0854 </td>
   <td style="text-align:right;"> 0.6667 </td>
   <td style="text-align:right;"> 0.6867 </td>
   <td style="text-align:right;"> 6.9997 </td>
   <td style="text-align:right;"> 9.1721 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[5] </td>
   <td style="text-align:right;"> 0.5282 </td>
   <td style="text-align:right;"> 0.5317 </td>
   <td style="text-align:right;"> 0.3280 </td>
   <td style="text-align:right;"> 0.3273 </td>
   <td style="text-align:right;"> -0.0172 </td>
   <td style="text-align:right;"> 1.0645 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[6] </td>
   <td style="text-align:right;"> 10.6332 </td>
   <td style="text-align:right;"> 10.5961 </td>
   <td style="text-align:right;"> 1.5705 </td>
   <td style="text-align:right;"> 1.5992 </td>
   <td style="text-align:right;"> 8.1346 </td>
   <td style="text-align:right;"> 13.2146 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[7] </td>
   <td style="text-align:right;"> -0.4265 </td>
   <td style="text-align:right;"> -0.4283 </td>
   <td style="text-align:right;"> 0.1300 </td>
   <td style="text-align:right;"> 0.1329 </td>
   <td style="text-align:right;"> -0.6363 </td>
   <td style="text-align:right;"> -0.2159 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[8] </td>
   <td style="text-align:right;"> 0.5706 </td>
   <td style="text-align:right;"> 0.5821 </td>
   <td style="text-align:right;"> 0.5070 </td>
   <td style="text-align:right;"> 0.5103 </td>
   <td style="text-align:right;"> -0.2499 </td>
   <td style="text-align:right;"> 1.4000 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-48_290c5525d23a257c5bc84ebe2845cafd">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-49_e1ebe3dda0083a455e47f0c51c2ca285">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-50_f949a2193e807de6fbfed1d80b90ed3d">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Binomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> <span class="fu">as.numeric</span>(dataBino<span class="sc">$</span>nPobreza), y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="regresión-multinomial-con-vínculo-logit" class="level2">
<h2 class="anchored" data-anchor-id="regresión-multinomial-con-vínculo-logit">Regresión multinomial con vínculo logit</h2>
<p>La distribución multinomial es una extensión de la distribución binomial, esta se aplica en situaciones donde hay un número fijo de ensayos independientes, donde cada el resultado de cada ensayo corresponde a una de <span class="math inline">\(K\)</span> categorías.</p>
<p>Generalizando lo anterior, se considera <span class="math inline">\(\mathbf{Y}=\{\mathbf{Y}_1, \ldots, \mathbf{Y}_n\}\)</span> un conjunto de vectores aleatorios intercambiables cada una con distribución multinomial de parámetros <span class="math inline">\((n_i, \boldsymbol{\theta}_i)\)</span>. Note que todos lo vectores tienen <span class="math inline">\(K\)</span> categorias; en particular, el <span class="math inline">\(i\)</span>-ésimo vector del conjunto se define como <span class="math inline">\(\mathbf{Y}_i=(Y_{i1}, \ldots, Y_{iK})'\)</span>, el vector de parámetros de interés es <span class="math inline">\(\boldsymbol{\theta}_i=(\theta_{i1},\ldots, \theta_{iK})\)</span> con <span class="math inline">\(\sum_{k=1}^K\theta_{ik}=1\)</span>, y <span class="math inline">\(n_i=\sum_{k=1}^K Y_{ik}\)</span>, y por ende se tiene que la distribución, condicional a <span class="math inline">\(n_i\)</span>, de <span class="math inline">\(\mathbf{Y}_{i}\)</span> sigue una distribución multinomial tal que:</p>
<p><span class="math display">\[
\begin{equation}
p(\mathbf{Y}_{i}\mid n_i, \boldsymbol{\theta}_i)=\binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}
\end{equation}
\]</span></p>
<p>Con base en lo anterior, la verosimilitud de los datos se tiene mediante la siguiente expresión</p>
<p><span class="math display">\[
\begin{equation}
p(\mathbf{Y} \mid n, \boldsymbol{\theta})=\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}
\end{equation}
\]</span></p>
<p>Antes de proseguir con el modelamiento bayesiano, es útil notar que en este caso el vínculo no es un vector sino una matriz que responde a una relación lineal entre las covariables y una matriz de coeficientes de regresión, como se puede ver a continuación.</p>
<p><span class="math display">\[
\begin{equation*}
\begin{bmatrix}
  \eta_{11} &amp; \eta_{12} &amp; \cdots &amp; \eta_{1K} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \eta_{n1} &amp; \eta_{n2} &amp; \cdots &amp; \eta_{nK}
\end{bmatrix}
=
\begin{bmatrix}
  X_{11} &amp; X_{12} &amp; \cdots &amp; X_{1q} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  X_{n1} &amp; X_{n2} &amp; \cdots &amp; X_{nq}
\end{bmatrix}
\begin{bmatrix}
  \beta_{11} &amp; \beta_{12} &amp; \cdots &amp; \beta_{1K} \\
  \vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
  \beta_{q1} &amp; \beta_{q2} &amp; \cdots &amp; \beta_{qK}
\end{bmatrix}
\end{equation*}
\]</span></p>
<p>Es decir,</p>
<p><span class="math display">\[
\begin{equation}
\boldsymbol{\eta}=\mathbf{X}'\boldsymbol{\beta}
\end{equation}
\]</span></p>
<p>Lo anterior conlleva a que <span class="math inline">\(\eta_{ik}=\mathbf{X}_i'\boldsymbol{\beta}_k\)</span>, donde <span class="math inline">\(\mathbf{X}_i\)</span> es la <span class="math inline">\(i\)</span>-ésima fila de la matriz <span class="math inline">\(\mathbf{X}\)</span> y <span class="math inline">\(\boldsymbol{\beta}_k\)</span> es la <span class="math inline">\(k\)</span>-ésima columna de la matriz <span class="math inline">\(\boldsymbol{\beta}\)</span>. Ahora, tomando como línea de base la primera columna de la matriz <span class="math inline">\(\boldsymbol{\eta}\)</span> (es decir, el vector de las probabilidades de la categoría 1 para los <span class="math inline">\(n\)</span> individuos), y utilizando la función de vinculo logístico, se tiene que para los elementos en las restantes columnas de <span class="math inline">\(\boldsymbol{\eta}\)</span>,</p>
<p><span class="math display">\[
\begin{equation}
\eta_{ik}=g(\theta_{ik})=\log\left(\frac{\theta_{ik}}{\theta_{i1}}\right)=\log\left(\frac{\theta_{ik}}{\theta_{i1}}\right)
\end{equation}
\]</span> Con un poco de álgebra se comprueba que la función inversa para <span class="math inline">\(g(\cdot)\)</span> está dada por la siguiente expresión</p>
<p><span class="math display">\[
\begin{equation}
\theta_{ik}=g^{-1}(\eta_{ik})=\theta_{i1}\exp(\eta_{ik}) \ \ \ \ \ \forall k=2,\ldots,K
\end{equation}
\]</span></p>
<p>Ahora, para la primera columna de <span class="math inline">\(\boldsymbol{\eta}\)</span>, es decir, el vector de probabilidades de la primera categoría, se tiene que</p>
<p><span class="math display">\[
\begin{equation*}
\theta_{i1}=1-\sum_{j=2}^K\theta_{ij}=1-\sum_{j=2}^K\theta_{i1}\exp(\eta_{ij})
\end{equation*}
\]</span></p>
<p>de donde se tiene que</p>
<p><span class="math display">\[
\begin{equation}
\theta_{i1}=\frac{1}{1+\sum_{j=2}^K\exp(\eta_{ij})}
\end{equation}
\]</span></p>
<p>Finalmente, se tiene que <span class="math display">\[
\begin{equation*}
\theta_{ik}=\frac{\exp(\eta_{ik})}{1+\sum_{k=2}^K\exp(\eta_{ik})} \ \ \ \ \forall k=1,\ldots,K
\end{equation*}
\]</span></p>
<p>con <span class="math inline">\(\boldsymbol{\beta}_1=0\)</span>, esto es <span class="math inline">\(\eta_{i1}=0\)</span> para todo <span class="math inline">\(i\)</span>. Notando que <span class="math inline">\(\eta_{ik}=\mathbf{X}_i'\boldsymbol{\beta}_k\)</span>, se tiene que la verosimilitud de los datos toma la siguiente forma</p>
<p><span class="math display">\[
\begin{align*}
p(\mathbf{Y} \mid n, \boldsymbol{\theta})=&amp;\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}\prod_{k=1}^K\theta_{ik}^{y_{ik}}\\
p(\mathbf{Y} \mid n, \boldsymbol{\beta})=&amp;\prod_{i=1}^n \binom{n_i}{y_{i1}, \ldots, y_{iK}}
\prod_{k=1}^K\left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}{1+\sum_{k=2}^K\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}\right)^{y_{ik}}\\
\end{align*}
\]</span></p>
<p>Suponiendo que la distribución a priori para <span class="math inline">\(\boldsymbol{\beta}_k\)</span> está regida por la siguiente estructura probabilística <span class="math display">\[
\begin{equation*}
\boldsymbol{\beta}_k\sim N_q(\mathbf{b}_k,\mathbf{B}_k)
\end{equation*}
\]</span></p>
<p>De esta manera, la distribución a posteriori para el <span class="math inline">\(k\)</span> ésimo vector <span class="math inline">\(\boldsymbol{\beta}_k\)</span> toma la siguiente forma.</p>
<p><span class="math display">\[
\begin{align*}
p(\boldsymbol{\beta}_k \mid \mathbf{Y}, \mathbf{X}, n)&amp;\propto
\prod_{i=1}^n \left(\frac{\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}{1+\sum_{k=2}^K\exp(\mathbf{X}_i'\boldsymbol{\beta}_k)}\right)^{y_{ik}}\\
&amp;\hspace{2cm}\times
\exp\left\{-\frac{1}{2}(\boldsymbol{\beta}-\mathbf{b})'\mathbf{B}^{-1}(\boldsymbol{\beta}-\mathbf{b})\right\}
\end{align*}
\]</span></p>
<p>Una vez más, la anterior expresión no tiene una forma cerrada.</p>
<section id="práctica-en-stan-2" class="level3">
<h3 class="anchored" data-anchor-id="práctica-en-stan-2">Práctica en <code>STAN</code></h3>
<p>Datos de la encuesta</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-51_0009b15e8286442138ea1fb325c230aa">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dataMultinomial <span class="ot">&lt;-</span> encuesta <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(edad <span class="sc">&gt;=</span> <span class="dv">18</span>, condact3 <span class="sc">%in%</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">dam =</span> <span class="fu">str_pad</span>(dam_ee, <span class="at">width =</span> <span class="dv">2</span>, <span class="at">pad =</span> <span class="st">"0"</span>),</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">empleo =</span> <span class="fu">as_factor</span>(condact3),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(dam, empleo) <span class="sc">%&gt;%</span> </span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>   <span class="fu">tally</span>() <span class="sc">%&gt;%</span> <span class="fu">data.frame</span>()</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>dataMultinomial <span class="ot">&lt;-</span> dataMultinomial <span class="sc">%&gt;%</span></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">spread</span>(<span class="at">key =</span> <span class="st">"empleo"</span>,<span class="at">value =</span> <span class="st">"n"</span>, <span class="at">fill =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a> <span class="fu">inner_join</span>(statelevel_predictors_df, <span class="at">by =</span> <span class="st">"dam"</span>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a>dataMultinomial <span class="ot">&lt;-</span></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>  dataMultinomial <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="at">Ocupado =</span> <span class="st">"1"</span>,</span>
<span id="cb55-15"><a href="#cb55-15" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Desocupado =</span> <span class="st">"2"</span>,</span>
<span id="cb55-16"><a href="#cb55-16" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Inactivo =</span> <span class="st">"3"</span>)</span>
<span id="cb55-17"><a href="#cb55-17" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(dataMultinomial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> dam </th>
   <th style="text-align:right;"> Ocupado </th>
   <th style="text-align:right;"> Desocupado </th>
   <th style="text-align:right;"> Inactivo </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> luces_nocturnas </th>
   <th style="text-align:right;"> suelo_cultivos </th>
   <th style="text-align:right;"> suelo_urbanos </th>
   <th style="text-align:right;"> area1 </th>
   <th style="text-align:right;"> etnia2 </th>
   <th style="text-align:right;"> sexo2 </th>
   <th style="text-align:right;"> edad2 </th>
   <th style="text-align:right;"> edad3 </th>
   <th style="text-align:right;"> edad4 </th>
   <th style="text-align:right;"> edad5 </th>
   <th style="text-align:right;"> anoest2 </th>
   <th style="text-align:right;"> anoest3 </th>
   <th style="text-align:right;"> anoest4 </th>
   <th style="text-align:right;"> etnia1 </th>
   <th style="text-align:right;"> tiene_alcantarillado </th>
   <th style="text-align:right;"> tiene_electricidad </th>
   <th style="text-align:right;"> tiene_acueducto </th>
   <th style="text-align:right;"> tiene_gas </th>
   <th style="text-align:right;"> eliminar_basura </th>
   <th style="text-align:right;"> tiene_internet </th>
   <th style="text-align:right;"> piso_tierra </th>
   <th style="text-align:right;"> material_paredes </th>
   <th style="text-align:right;"> material_techo </th>
   <th style="text-align:right;"> rezago_escolar </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> hacinamiento </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> 01 </td>
   <td style="text-align:right;"> 1863 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 737 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 25.4075 </td>
   <td style="text-align:right;"> 12.3671 </td>
   <td style="text-align:right;"> 13.5749 </td>
   <td style="text-align:right;"> 0.9124 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.5193 </td>
   <td style="text-align:right;"> 0.2915 </td>
   <td style="text-align:right;"> 0.2128 </td>
   <td style="text-align:right;"> 0.1624 </td>
   <td style="text-align:right;"> 0.0657 </td>
   <td style="text-align:right;"> 0.3094 </td>
   <td style="text-align:right;"> 0.3764 </td>
   <td style="text-align:right;"> 0.1137 </td>
   <td style="text-align:right;"> 0.1346 </td>
   <td style="text-align:right;"> 0.2125 </td>
   <td style="text-align:right;"> 0.0089 </td>
   <td style="text-align:right;"> 0.0963 </td>
   <td style="text-align:right;"> 0.1474 </td>
   <td style="text-align:right;"> 0.1479 </td>
   <td style="text-align:right;"> 0.5846 </td>
   <td style="text-align:right;"> 0.0561 </td>
   <td style="text-align:right;"> 0.0979 </td>
   <td style="text-align:right;"> 0.0228 </td>
   <td style="text-align:right;"> 0.1776 </td>
   <td style="text-align:right;"> 0.0662 </td>
   <td style="text-align:right;"> 0.3385 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 02 </td>
   <td style="text-align:right;"> 657 </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 463 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 3.0275 </td>
   <td style="text-align:right;"> 25.3519 </td>
   <td style="text-align:right;"> 0.9920 </td>
   <td style="text-align:right;"> 0.5176 </td>
   <td style="text-align:right;"> 0.0015 </td>
   <td style="text-align:right;"> 0.5065 </td>
   <td style="text-align:right;"> 0.2867 </td>
   <td style="text-align:right;"> 0.1893 </td>
   <td style="text-align:right;"> 0.1490 </td>
   <td style="text-align:right;"> 0.0696 </td>
   <td style="text-align:right;"> 0.4022 </td>
   <td style="text-align:right;"> 0.2926 </td>
   <td style="text-align:right;"> 0.0350 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 0.6296 </td>
   <td style="text-align:right;"> 0.0629 </td>
   <td style="text-align:right;"> 0.1756 </td>
   <td style="text-align:right;"> 0.4667 </td>
   <td style="text-align:right;"> 0.5596 </td>
   <td style="text-align:right;"> 0.8879 </td>
   <td style="text-align:right;"> 0.1277 </td>
   <td style="text-align:right;"> 0.0776 </td>
   <td style="text-align:right;"> 0.0270 </td>
   <td style="text-align:right;"> 0.0573 </td>
   <td style="text-align:right;"> 0.1377 </td>
   <td style="text-align:right;"> 0.4128 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 03 </td>
   <td style="text-align:right;"> 1566 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 664 </td>
   <td style="text-align:right;"> 0.0230 </td>
   <td style="text-align:right;"> 19.9710 </td>
   <td style="text-align:right;"> 9.2249 </td>
   <td style="text-align:right;"> 7.4542 </td>
   <td style="text-align:right;"> 0.8847 </td>
   <td style="text-align:right;"> 0.0028 </td>
   <td style="text-align:right;"> 0.5107 </td>
   <td style="text-align:right;"> 0.3031 </td>
   <td style="text-align:right;"> 0.2042 </td>
   <td style="text-align:right;"> 0.1447 </td>
   <td style="text-align:right;"> 0.0602 </td>
   <td style="text-align:right;"> 0.3918 </td>
   <td style="text-align:right;"> 0.3123 </td>
   <td style="text-align:right;"> 0.0665 </td>
   <td style="text-align:right;"> 0.4024 </td>
   <td style="text-align:right;"> 0.1464 </td>
   <td style="text-align:right;"> 0.0110 </td>
   <td style="text-align:right;"> 0.0725 </td>
   <td style="text-align:right;"> 0.3270 </td>
   <td style="text-align:right;"> 0.1923 </td>
   <td style="text-align:right;"> 0.7539 </td>
   <td style="text-align:right;"> 0.1173 </td>
   <td style="text-align:right;"> 0.1291 </td>
   <td style="text-align:right;"> 0.0266 </td>
   <td style="text-align:right;"> 0.1084 </td>
   <td style="text-align:right;"> 0.1023 </td>
   <td style="text-align:right;"> 0.3886 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 04 </td>
   <td style="text-align:right;"> 962 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 387 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 7.0750 </td>
   <td style="text-align:right;"> 11.8985 </td>
   <td style="text-align:right;"> 3.1658 </td>
   <td style="text-align:right;"> 0.5413 </td>
   <td style="text-align:right;"> 0.0030 </td>
   <td style="text-align:right;"> 0.5174 </td>
   <td style="text-align:right;"> 0.3069 </td>
   <td style="text-align:right;"> 0.1789 </td>
   <td style="text-align:right;"> 0.1245 </td>
   <td style="text-align:right;"> 0.0495 </td>
   <td style="text-align:right;"> 0.4451 </td>
   <td style="text-align:right;"> 0.2361 </td>
   <td style="text-align:right;"> 0.0289 </td>
   <td style="text-align:right;"> 0.7821 </td>
   <td style="text-align:right;"> 0.4722 </td>
   <td style="text-align:right;"> 0.0382 </td>
   <td style="text-align:right;"> 0.2644 </td>
   <td style="text-align:right;"> 0.6590 </td>
   <td style="text-align:right;"> 0.5784 </td>
   <td style="text-align:right;"> 0.8763 </td>
   <td style="text-align:right;"> 0.1530 </td>
   <td style="text-align:right;"> 0.0824 </td>
   <td style="text-align:right;"> 0.0064 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.1628 </td>
   <td style="text-align:right;"> 0.5231 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 05 </td>
   <td style="text-align:right;"> 1076 </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 642 </td>
   <td style="text-align:right;"> 0.0525 </td>
   <td style="text-align:right;"> 7.1401 </td>
   <td style="text-align:right;"> 35.2899 </td>
   <td style="text-align:right;"> 2.2458 </td>
   <td style="text-align:right;"> 0.6118 </td>
   <td style="text-align:right;"> 0.0033 </td>
   <td style="text-align:right;"> 0.5015 </td>
   <td style="text-align:right;"> 0.3015 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.1375 </td>
   <td style="text-align:right;"> 0.0545 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.2994 </td>
   <td style="text-align:right;"> 0.0309 </td>
   <td style="text-align:right;"> 0.0510 </td>
   <td style="text-align:right;"> 0.5050 </td>
   <td style="text-align:right;"> 0.0324 </td>
   <td style="text-align:right;"> 0.4462 </td>
   <td style="text-align:right;"> 0.3742 </td>
   <td style="text-align:right;"> 0.5600 </td>
   <td style="text-align:right;"> 0.8798 </td>
   <td style="text-align:right;"> 0.1202 </td>
   <td style="text-align:right;"> 0.1214 </td>
   <td style="text-align:right;"> 0.0307 </td>
   <td style="text-align:right;"> 0.0512 </td>
   <td style="text-align:right;"> 0.1362 </td>
   <td style="text-align:right;"> 0.5027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 06 </td>
   <td style="text-align:right;"> 594 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 359 </td>
   <td style="text-align:right;"> 0.0305 </td>
   <td style="text-align:right;"> 3.2267 </td>
   <td style="text-align:right;"> 26.5864 </td>
   <td style="text-align:right;"> 0.8061 </td>
   <td style="text-align:right;"> 0.4645 </td>
   <td style="text-align:right;"> 0.0039 </td>
   <td style="text-align:right;"> 0.5069 </td>
   <td style="text-align:right;"> 0.2929 </td>
   <td style="text-align:right;"> 0.1801 </td>
   <td style="text-align:right;"> 0.1433 </td>
   <td style="text-align:right;"> 0.0650 </td>
   <td style="text-align:right;"> 0.4243 </td>
   <td style="text-align:right;"> 0.2587 </td>
   <td style="text-align:right;"> 0.0311 </td>
   <td style="text-align:right;"> 0.1607 </td>
   <td style="text-align:right;"> 0.7005 </td>
   <td style="text-align:right;"> 0.0741 </td>
   <td style="text-align:right;"> 0.2722 </td>
   <td style="text-align:right;"> 0.5872 </td>
   <td style="text-align:right;"> 0.6553 </td>
   <td style="text-align:right;"> 0.9029 </td>
   <td style="text-align:right;"> 0.1937 </td>
   <td style="text-align:right;"> 0.0865 </td>
   <td style="text-align:right;"> 0.0379 </td>
   <td style="text-align:right;"> 0.0524 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.4720 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 07 </td>
   <td style="text-align:right;"> 795 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 416 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 7.2985 </td>
   <td style="text-align:right;"> 8.7206 </td>
   <td style="text-align:right;"> 3.7948 </td>
   <td style="text-align:right;"> 0.6156 </td>
   <td style="text-align:right;"> 0.0018 </td>
   <td style="text-align:right;"> 0.5226 </td>
   <td style="text-align:right;"> 0.3085 </td>
   <td style="text-align:right;"> 0.1840 </td>
   <td style="text-align:right;"> 0.1261 </td>
   <td style="text-align:right;"> 0.0511 </td>
   <td style="text-align:right;"> 0.3822 </td>
   <td style="text-align:right;"> 0.2154 </td>
   <td style="text-align:right;"> 0.0243 </td>
   <td style="text-align:right;"> 0.9638 </td>
   <td style="text-align:right;"> 0.7169 </td>
   <td style="text-align:right;"> 0.0485 </td>
   <td style="text-align:right;"> 0.0690 </td>
   <td style="text-align:right;"> 0.8503 </td>
   <td style="text-align:right;"> 0.6225 </td>
   <td style="text-align:right;"> 0.9198 </td>
   <td style="text-align:right;"> 0.1591 </td>
   <td style="text-align:right;"> 0.0482 </td>
   <td style="text-align:right;"> 0.0036 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.2897 </td>
   <td style="text-align:right;"> 0.5434 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 08 </td>
   <td style="text-align:right;"> 792 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 438 </td>
   <td style="text-align:right;"> 0.0161 </td>
   <td style="text-align:right;"> 8.5521 </td>
   <td style="text-align:right;"> 11.9767 </td>
   <td style="text-align:right;"> 5.8417 </td>
   <td style="text-align:right;"> 0.4896 </td>
   <td style="text-align:right;"> 0.0016 </td>
   <td style="text-align:right;"> 0.5310 </td>
   <td style="text-align:right;"> 0.3064 </td>
   <td style="text-align:right;"> 0.1627 </td>
   <td style="text-align:right;"> 0.1298 </td>
   <td style="text-align:right;"> 0.0562 </td>
   <td style="text-align:right;"> 0.4401 </td>
   <td style="text-align:right;"> 0.1702 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 0.9801 </td>
   <td style="text-align:right;"> 0.7864 </td>
   <td style="text-align:right;"> 0.0513 </td>
   <td style="text-align:right;"> 0.3053 </td>
   <td style="text-align:right;"> 0.8603 </td>
   <td style="text-align:right;"> 0.8980 </td>
   <td style="text-align:right;"> 0.9318 </td>
   <td style="text-align:right;"> 0.2931 </td>
   <td style="text-align:right;"> 0.0102 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.0366 </td>
   <td style="text-align:right;"> 0.2904 </td>
   <td style="text-align:right;"> 0.6049 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 09 </td>
   <td style="text-align:right;"> 1135 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 671 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 9.4656 </td>
   <td style="text-align:right;"> 18.2660 </td>
   <td style="text-align:right;"> 6.0706 </td>
   <td style="text-align:right;"> 0.6155 </td>
   <td style="text-align:right;"> 0.0023 </td>
   <td style="text-align:right;"> 0.5272 </td>
   <td style="text-align:right;"> 0.3001 </td>
   <td style="text-align:right;"> 0.1810 </td>
   <td style="text-align:right;"> 0.1431 </td>
   <td style="text-align:right;"> 0.0627 </td>
   <td style="text-align:right;"> 0.3882 </td>
   <td style="text-align:right;"> 0.2586 </td>
   <td style="text-align:right;"> 0.0669 </td>
   <td style="text-align:right;"> 0.5089 </td>
   <td style="text-align:right;"> 0.4037 </td>
   <td style="text-align:right;"> 0.0394 </td>
   <td style="text-align:right;"> 0.2054 </td>
   <td style="text-align:right;"> 0.5427 </td>
   <td style="text-align:right;"> 0.5401 </td>
   <td style="text-align:right;"> 0.8210 </td>
   <td style="text-align:right;"> 0.0990 </td>
   <td style="text-align:right;"> 0.0321 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.1692 </td>
   <td style="text-align:right;"> 0.4582 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 10 </td>
   <td style="text-align:right;"> 1003 </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 522 </td>
   <td style="text-align:right;"> 0.0338 </td>
   <td style="text-align:right;"> 5.1872 </td>
   <td style="text-align:right;"> 29.3599 </td>
   <td style="text-align:right;"> 1.6822 </td>
   <td style="text-align:right;"> 0.4799 </td>
   <td style="text-align:right;"> 0.0075 </td>
   <td style="text-align:right;"> 0.5091 </td>
   <td style="text-align:right;"> 0.2985 </td>
   <td style="text-align:right;"> 0.1764 </td>
   <td style="text-align:right;"> 0.1278 </td>
   <td style="text-align:right;"> 0.0549 </td>
   <td style="text-align:right;"> 0.4026 </td>
   <td style="text-align:right;"> 0.2424 </td>
   <td style="text-align:right;"> 0.0285 </td>
   <td style="text-align:right;"> 0.3810 </td>
   <td style="text-align:right;"> 0.3954 </td>
   <td style="text-align:right;"> 0.0606 </td>
   <td style="text-align:right;"> 0.3155 </td>
   <td style="text-align:right;"> 0.6388 </td>
   <td style="text-align:right;"> 0.6333 </td>
   <td style="text-align:right;"> 0.9022 </td>
   <td style="text-align:right;"> 0.1896 </td>
   <td style="text-align:right;"> 0.0949 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.1993 </td>
   <td style="text-align:right;"> 0.5800 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 11 </td>
   <td style="text-align:right;"> 673 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 354 </td>
   <td style="text-align:right;"> 0.0426 </td>
   <td style="text-align:right;"> 4.8694 </td>
   <td style="text-align:right;"> 37.4208 </td>
   <td style="text-align:right;"> 1.4296 </td>
   <td style="text-align:right;"> 0.5734 </td>
   <td style="text-align:right;"> 0.0029 </td>
   <td style="text-align:right;"> 0.5112 </td>
   <td style="text-align:right;"> 0.2994 </td>
   <td style="text-align:right;"> 0.1774 </td>
   <td style="text-align:right;"> 0.1304 </td>
   <td style="text-align:right;"> 0.0596 </td>
   <td style="text-align:right;"> 0.3953 </td>
   <td style="text-align:right;"> 0.2727 </td>
   <td style="text-align:right;"> 0.0310 </td>
   <td style="text-align:right;"> 0.1497 </td>
   <td style="text-align:right;"> 0.6088 </td>
   <td style="text-align:right;"> 0.0596 </td>
   <td style="text-align:right;"> 0.4863 </td>
   <td style="text-align:right;"> 0.6480 </td>
   <td style="text-align:right;"> 0.7537 </td>
   <td style="text-align:right;"> 0.9001 </td>
   <td style="text-align:right;"> 0.2132 </td>
   <td style="text-align:right;"> 0.0750 </td>
   <td style="text-align:right;"> 0.0320 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.1704 </td>
   <td style="text-align:right;"> 0.5414 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 12 </td>
   <td style="text-align:right;"> 683 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 405 </td>
   <td style="text-align:right;"> 0.0255 </td>
   <td style="text-align:right;"> 5.7895 </td>
   <td style="text-align:right;"> 13.9958 </td>
   <td style="text-align:right;"> 2.6080 </td>
   <td style="text-align:right;"> 0.2538 </td>
   <td style="text-align:right;"> 0.0012 </td>
   <td style="text-align:right;"> 0.5145 </td>
   <td style="text-align:right;"> 0.2818 </td>
   <td style="text-align:right;"> 0.1623 </td>
   <td style="text-align:right;"> 0.1258 </td>
   <td style="text-align:right;"> 0.0588 </td>
   <td style="text-align:right;"> 0.4354 </td>
   <td style="text-align:right;"> 0.1972 </td>
   <td style="text-align:right;"> 0.0264 </td>
   <td style="text-align:right;"> 0.3082 </td>
   <td style="text-align:right;"> 0.7269 </td>
   <td style="text-align:right;"> 0.0783 </td>
   <td style="text-align:right;"> 0.2898 </td>
   <td style="text-align:right;"> 0.7986 </td>
   <td style="text-align:right;"> 0.8373 </td>
   <td style="text-align:right;"> 0.9338 </td>
   <td style="text-align:right;"> 0.2352 </td>
   <td style="text-align:right;"> 0.0333 </td>
   <td style="text-align:right;"> 0.0116 </td>
   <td style="text-align:right;"> 0.0489 </td>
   <td style="text-align:right;"> 0.2222 </td>
   <td style="text-align:right;"> 0.6140 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 13 </td>
   <td style="text-align:right;"> 696 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 513 </td>
   <td style="text-align:right;"> 0.0210 </td>
   <td style="text-align:right;"> 2.0043 </td>
   <td style="text-align:right;"> 11.8076 </td>
   <td style="text-align:right;"> 1.5148 </td>
   <td style="text-align:right;"> 0.2796 </td>
   <td style="text-align:right;"> 0.0019 </td>
   <td style="text-align:right;"> 0.5241 </td>
   <td style="text-align:right;"> 0.2873 </td>
   <td style="text-align:right;"> 0.1613 </td>
   <td style="text-align:right;"> 0.1135 </td>
   <td style="text-align:right;"> 0.0508 </td>
   <td style="text-align:right;"> 0.4526 </td>
   <td style="text-align:right;"> 0.1227 </td>
   <td style="text-align:right;"> 0.0211 </td>
   <td style="text-align:right;"> 0.6500 </td>
   <td style="text-align:right;"> 0.6501 </td>
   <td style="text-align:right;"> 0.1352 </td>
   <td style="text-align:right;"> 0.3101 </td>
   <td style="text-align:right;"> 0.8202 </td>
   <td style="text-align:right;"> 0.8131 </td>
   <td style="text-align:right;"> 0.9168 </td>
   <td style="text-align:right;"> 0.3014 </td>
   <td style="text-align:right;"> 0.0251 </td>
   <td style="text-align:right;"> 0.0052 </td>
   <td style="text-align:right;"> 0.0404 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.6159 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 14 </td>
   <td style="text-align:right;"> 739 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 472 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 1.6086 </td>
   <td style="text-align:right;"> 10.0401 </td>
   <td style="text-align:right;"> 0.7361 </td>
   <td style="text-align:right;"> 0.3230 </td>
   <td style="text-align:right;"> 0.0024 </td>
   <td style="text-align:right;"> 0.5203 </td>
   <td style="text-align:right;"> 0.2999 </td>
   <td style="text-align:right;"> 0.1543 </td>
   <td style="text-align:right;"> 0.1123 </td>
   <td style="text-align:right;"> 0.0449 </td>
   <td style="text-align:right;"> 0.4133 </td>
   <td style="text-align:right;"> 0.1335 </td>
   <td style="text-align:right;"> 0.0142 </td>
   <td style="text-align:right;"> 0.8918 </td>
   <td style="text-align:right;"> 0.7871 </td>
   <td style="text-align:right;"> 0.1401 </td>
   <td style="text-align:right;"> 0.3138 </td>
   <td style="text-align:right;"> 0.8974 </td>
   <td style="text-align:right;"> 0.8772 </td>
   <td style="text-align:right;"> 0.9582 </td>
   <td style="text-align:right;"> 0.3939 </td>
   <td style="text-align:right;"> 0.0223 </td>
   <td style="text-align:right;"> 0.0129 </td>
   <td style="text-align:right;"> 0.0277 </td>
   <td style="text-align:right;"> 0.3674 </td>
   <td style="text-align:right;"> 0.6634 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 15 </td>
   <td style="text-align:right;"> 562 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 296 </td>
   <td style="text-align:right;"> 0.0201 </td>
   <td style="text-align:right;"> 1.3088 </td>
   <td style="text-align:right;"> 12.8529 </td>
   <td style="text-align:right;"> 0.4211 </td>
   <td style="text-align:right;"> 0.4016 </td>
   <td style="text-align:right;"> 0.0026 </td>
   <td style="text-align:right;"> 0.5161 </td>
   <td style="text-align:right;"> 0.2968 </td>
   <td style="text-align:right;"> 0.1707 </td>
   <td style="text-align:right;"> 0.1249 </td>
   <td style="text-align:right;"> 0.0558 </td>
   <td style="text-align:right;"> 0.4003 </td>
   <td style="text-align:right;"> 0.2005 </td>
   <td style="text-align:right;"> 0.0264 </td>
   <td style="text-align:right;"> 0.6004 </td>
   <td style="text-align:right;"> 0.7507 </td>
   <td style="text-align:right;"> 0.1587 </td>
   <td style="text-align:right;"> 0.2574 </td>
   <td style="text-align:right;"> 0.7546 </td>
   <td style="text-align:right;"> 0.7979 </td>
   <td style="text-align:right;"> 0.9167 </td>
   <td style="text-align:right;"> 0.2960 </td>
   <td style="text-align:right;"> 0.0539 </td>
   <td style="text-align:right;"> 0.0076 </td>
   <td style="text-align:right;"> 0.0481 </td>
   <td style="text-align:right;"> 0.2711 </td>
   <td style="text-align:right;"> 0.5392 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 16 </td>
   <td style="text-align:right;"> 715 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 361 </td>
   <td style="text-align:right;"> 0.0224 </td>
   <td style="text-align:right;"> 0.7126 </td>
   <td style="text-align:right;"> 12.5184 </td>
   <td style="text-align:right;"> 0.4974 </td>
   <td style="text-align:right;"> 0.3125 </td>
   <td style="text-align:right;"> 0.0020 </td>
   <td style="text-align:right;"> 0.5038 </td>
   <td style="text-align:right;"> 0.2973 </td>
   <td style="text-align:right;"> 0.1724 </td>
   <td style="text-align:right;"> 0.1019 </td>
   <td style="text-align:right;"> 0.0398 </td>
   <td style="text-align:right;"> 0.3897 </td>
   <td style="text-align:right;"> 0.1610 </td>
   <td style="text-align:right;"> 0.0185 </td>
   <td style="text-align:right;"> 0.9296 </td>
   <td style="text-align:right;"> 0.8622 </td>
   <td style="text-align:right;"> 0.3541 </td>
   <td style="text-align:right;"> 0.5473 </td>
   <td style="text-align:right;"> 0.8818 </td>
   <td style="text-align:right;"> 0.8660 </td>
   <td style="text-align:right;"> 0.9424 </td>
   <td style="text-align:right;"> 0.5713 </td>
   <td style="text-align:right;"> 0.1333 </td>
   <td style="text-align:right;"> 0.0550 </td>
   <td style="text-align:right;"> 0.0367 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.7164 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 17 </td>
   <td style="text-align:right;"> 890 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 480 </td>
   <td style="text-align:right;"> 0.0248 </td>
   <td style="text-align:right;"> 0.2952 </td>
   <td style="text-align:right;"> 28.4407 </td>
   <td style="text-align:right;"> 0.2350 </td>
   <td style="text-align:right;"> 0.4047 </td>
   <td style="text-align:right;"> 0.0029 </td>
   <td style="text-align:right;"> 0.4999 </td>
   <td style="text-align:right;"> 0.3131 </td>
   <td style="text-align:right;"> 0.1698 </td>
   <td style="text-align:right;"> 0.1117 </td>
   <td style="text-align:right;"> 0.0421 </td>
   <td style="text-align:right;"> 0.4033 </td>
   <td style="text-align:right;"> 0.2185 </td>
   <td style="text-align:right;"> 0.0237 </td>
   <td style="text-align:right;"> 0.3024 </td>
   <td style="text-align:right;"> 0.9454 </td>
   <td style="text-align:right;"> 0.1586 </td>
   <td style="text-align:right;"> 0.3934 </td>
   <td style="text-align:right;"> 0.7241 </td>
   <td style="text-align:right;"> 0.8357 </td>
   <td style="text-align:right;"> 0.9083 </td>
   <td style="text-align:right;"> 0.3225 </td>
   <td style="text-align:right;"> 0.0450 </td>
   <td style="text-align:right;"> 0.1228 </td>
   <td style="text-align:right;"> 0.0454 </td>
   <td style="text-align:right;"> 0.2250 </td>
   <td style="text-align:right;"> 0.5325 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 18 </td>
   <td style="text-align:right;"> 556 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 390 </td>
   <td style="text-align:right;"> 0.0346 </td>
   <td style="text-align:right;"> 0.7454 </td>
   <td style="text-align:right;"> 27.9997 </td>
   <td style="text-align:right;"> 0.6191 </td>
   <td style="text-align:right;"> 0.4102 </td>
   <td style="text-align:right;"> 0.0111 </td>
   <td style="text-align:right;"> 0.5061 </td>
   <td style="text-align:right;"> 0.3008 </td>
   <td style="text-align:right;"> 0.1780 </td>
   <td style="text-align:right;"> 0.1289 </td>
   <td style="text-align:right;"> 0.0533 </td>
   <td style="text-align:right;"> 0.4088 </td>
   <td style="text-align:right;"> 0.2479 </td>
   <td style="text-align:right;"> 0.0241 </td>
   <td style="text-align:right;"> 0.2824 </td>
   <td style="text-align:right;"> 0.7144 </td>
   <td style="text-align:right;"> 0.1412 </td>
   <td style="text-align:right;"> 0.3129 </td>
   <td style="text-align:right;"> 0.5191 </td>
   <td style="text-align:right;"> 0.6713 </td>
   <td style="text-align:right;"> 0.8758 </td>
   <td style="text-align:right;"> 0.2242 </td>
   <td style="text-align:right;"> 0.0885 </td>
   <td style="text-align:right;"> 0.0833 </td>
   <td style="text-align:right;"> 0.0431 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.5070 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 19 </td>
   <td style="text-align:right;"> 616 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 262 </td>
   <td style="text-align:right;"> 0.0360 </td>
   <td style="text-align:right;"> 2.6224 </td>
   <td style="text-align:right;"> 34.2277 </td>
   <td style="text-align:right;"> 1.5445 </td>
   <td style="text-align:right;"> 0.4421 </td>
   <td style="text-align:right;"> 0.0046 </td>
   <td style="text-align:right;"> 0.5100 </td>
   <td style="text-align:right;"> 0.2927 </td>
   <td style="text-align:right;"> 0.1818 </td>
   <td style="text-align:right;"> 0.1459 </td>
   <td style="text-align:right;"> 0.0685 </td>
   <td style="text-align:right;"> 0.4138 </td>
   <td style="text-align:right;"> 0.2424 </td>
   <td style="text-align:right;"> 0.0357 </td>
   <td style="text-align:right;"> 0.0196 </td>
   <td style="text-align:right;"> 0.5975 </td>
   <td style="text-align:right;"> 0.0908 </td>
   <td style="text-align:right;"> 0.1855 </td>
   <td style="text-align:right;"> 0.5241 </td>
   <td style="text-align:right;"> 0.5707 </td>
   <td style="text-align:right;"> 0.8760 </td>
   <td style="text-align:right;"> 0.1602 </td>
   <td style="text-align:right;"> 0.1781 </td>
   <td style="text-align:right;"> 0.0122 </td>
   <td style="text-align:right;"> 0.0593 </td>
   <td style="text-align:right;"> 0.1850 </td>
   <td style="text-align:right;"> 0.4456 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 20 </td>
   <td style="text-align:right;"> 591 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 332 </td>
   <td style="text-align:right;"> 0.0247 </td>
   <td style="text-align:right;"> 1.6756 </td>
   <td style="text-align:right;"> 36.7507 </td>
   <td style="text-align:right;"> 1.0935 </td>
   <td style="text-align:right;"> 0.3738 </td>
   <td style="text-align:right;"> 0.0038 </td>
   <td style="text-align:right;"> 0.5184 </td>
   <td style="text-align:right;"> 0.2940 </td>
   <td style="text-align:right;"> 0.1679 </td>
   <td style="text-align:right;"> 0.1280 </td>
   <td style="text-align:right;"> 0.0581 </td>
   <td style="text-align:right;"> 0.4066 </td>
   <td style="text-align:right;"> 0.1772 </td>
   <td style="text-align:right;"> 0.0272 </td>
   <td style="text-align:right;"> 0.2684 </td>
   <td style="text-align:right;"> 0.7037 </td>
   <td style="text-align:right;"> 0.1674 </td>
   <td style="text-align:right;"> 0.3505 </td>
   <td style="text-align:right;"> 0.6923 </td>
   <td style="text-align:right;"> 0.7061 </td>
   <td style="text-align:right;"> 0.8775 </td>
   <td style="text-align:right;"> 0.3376 </td>
   <td style="text-align:right;"> 0.2379 </td>
   <td style="text-align:right;"> 0.0689 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.2760 </td>
   <td style="text-align:right;"> 0.5397 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 21 </td>
   <td style="text-align:right;"> 735 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 444 </td>
   <td style="text-align:right;"> 0.0171 </td>
   <td style="text-align:right;"> 2.3243 </td>
   <td style="text-align:right;"> 36.0126 </td>
   <td style="text-align:right;"> 1.4146 </td>
   <td style="text-align:right;"> 0.6301 </td>
   <td style="text-align:right;"> 0.0044 </td>
   <td style="text-align:right;"> 0.5163 </td>
   <td style="text-align:right;"> 0.3020 </td>
   <td style="text-align:right;"> 0.1663 </td>
   <td style="text-align:right;"> 0.1219 </td>
   <td style="text-align:right;"> 0.0519 </td>
   <td style="text-align:right;"> 0.4309 </td>
   <td style="text-align:right;"> 0.1921 </td>
   <td style="text-align:right;"> 0.0269 </td>
   <td style="text-align:right;"> 0.3891 </td>
   <td style="text-align:right;"> 0.6828 </td>
   <td style="text-align:right;"> 0.1146 </td>
   <td style="text-align:right;"> 0.2511 </td>
   <td style="text-align:right;"> 0.7212 </td>
   <td style="text-align:right;"> 0.7398 </td>
   <td style="text-align:right;"> 0.8985 </td>
   <td style="text-align:right;"> 0.3761 </td>
   <td style="text-align:right;"> 0.0427 </td>
   <td style="text-align:right;"> 0.0063 </td>
   <td style="text-align:right;"> 0.0503 </td>
   <td style="text-align:right;"> 0.2224 </td>
   <td style="text-align:right;"> 0.5422 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> 22 </td>
   <td style="text-align:right;"> 918 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 742 </td>
   <td style="text-align:right;"> 0.0254 </td>
   <td style="text-align:right;"> 2.7178 </td>
   <td style="text-align:right;"> 52.3791 </td>
   <td style="text-align:right;"> 1.2857 </td>
   <td style="text-align:right;"> 0.5114 </td>
   <td style="text-align:right;"> 0.0037 </td>
   <td style="text-align:right;"> 0.5142 </td>
   <td style="text-align:right;"> 0.2928 </td>
   <td style="text-align:right;"> 0.1780 </td>
   <td style="text-align:right;"> 0.1436 </td>
   <td style="text-align:right;"> 0.0699 </td>
   <td style="text-align:right;"> 0.4247 </td>
   <td style="text-align:right;"> 0.2391 </td>
   <td style="text-align:right;"> 0.0296 </td>
   <td style="text-align:right;"> 0.2029 </td>
   <td style="text-align:right;"> 0.7283 </td>
   <td style="text-align:right;"> 0.0774 </td>
   <td style="text-align:right;"> 0.2188 </td>
   <td style="text-align:right;"> 0.6334 </td>
   <td style="text-align:right;"> 0.7355 </td>
   <td style="text-align:right;"> 0.9087 </td>
   <td style="text-align:right;"> 0.1964 </td>
   <td style="text-align:right;"> 0.0607 </td>
   <td style="text-align:right;"> 0.0100 </td>
   <td style="text-align:right;"> 0.0497 </td>
   <td style="text-align:right;"> 0.1929 </td>
   <td style="text-align:right;"> 0.4749 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>Creando código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-52_59ad794711de95a048a22096c5fe5848">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>data {</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> D;    <span class="sc">/</span><span class="er">/</span> Número de dominios </span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> P;    <span class="sc">/</span><span class="er">/</span> Categorías</span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  int<span class="sc">&lt;</span>lower<span class="ot">=</span><span class="dv">1</span><span class="sc">&gt;</span> K;    <span class="sc">/</span><span class="er">/</span> Número de regresores</span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>  int y[D, P];       <span class="sc">/</span><span class="er">/</span> Matriz de datos</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a>  matrix[D, K] X;    <span class="sc">/</span><span class="er">/</span> Matriz de covariables</span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>parameters {</span>
<span id="cb56-11"><a href="#cb56-11" aria-hidden="true" tabindex="-1"></a>  matrix[P<span class="dv">-1</span>, K] beta;<span class="sc">/</span><span class="er">/</span> Matriz de parámetros </span>
<span id="cb56-12"><a href="#cb56-12" aria-hidden="true" tabindex="-1"></a>                 </span>
<span id="cb56-13"><a href="#cb56-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-14"><a href="#cb56-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-15"><a href="#cb56-15" aria-hidden="true" tabindex="-1"></a>transformed parameters {</span>
<span id="cb56-16"><a href="#cb56-16" aria-hidden="true" tabindex="-1"></a>  simplex[P] theta[D];<span class="sc">/</span><span class="er">/</span> Vector de parámetros;</span>
<span id="cb56-17"><a href="#cb56-17" aria-hidden="true" tabindex="-1"></a>  real num[D, P];</span>
<span id="cb56-18"><a href="#cb56-18" aria-hidden="true" tabindex="-1"></a>  real den[D];</span>
<span id="cb56-19"><a href="#cb56-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-20"><a href="#cb56-20" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-21"><a href="#cb56-21" aria-hidden="true" tabindex="-1"></a>    num[d, <span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span>;</span>
<span id="cb56-22"><a href="#cb56-22" aria-hidden="true" tabindex="-1"></a>    num[d, <span class="dv">2</span>] <span class="ot">=</span> <span class="fu">exp</span>(X[d, ] <span class="sc">*</span> beta[<span class="dv">1</span>, ]<span class="st">') ;</span></span>
<span id="cb56-23"><a href="#cb56-23" aria-hidden="true" tabindex="-1"></a><span class="st">    num[d, 3] = exp(X[d, ] * beta[2, ]'</span>) ;</span>
<span id="cb56-24"><a href="#cb56-24" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb56-25"><a href="#cb56-25" aria-hidden="true" tabindex="-1"></a>    den[d] <span class="ot">=</span> <span class="fu">sum</span>(num[d, ]);</span>
<span id="cb56-26"><a href="#cb56-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-27"><a href="#cb56-27" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-28"><a href="#cb56-28" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-29"><a href="#cb56-29" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(p <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>P){</span>
<span id="cb56-30"><a href="#cb56-30" aria-hidden="true" tabindex="-1"></a>    theta[d, p] <span class="ot">=</span> num[d, p]<span class="sc">/</span>den[d];</span>
<span id="cb56-31"><a href="#cb56-31" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb56-32"><a href="#cb56-32" aria-hidden="true" tabindex="-1"></a>    theta[d, <span class="dv">1</span>] <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span>den[d];</span>
<span id="cb56-33"><a href="#cb56-33" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-34"><a href="#cb56-34" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-35"><a href="#cb56-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-36"><a href="#cb56-36" aria-hidden="true" tabindex="-1"></a>model {</span>
<span id="cb56-37"><a href="#cb56-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">to_vector</span>(beta) <span class="sc">~</span> <span class="fu">normal</span>(<span class="dv">0</span>, <span class="dv">100</span>);</span>
<span id="cb56-38"><a href="#cb56-38" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-39"><a href="#cb56-39" aria-hidden="true" tabindex="-1"></a>    target <span class="sc">+</span><span class="er">=</span> <span class="fu">multinomial_lpmf</span>(y[d, ] <span class="sc">|</span> theta[d, ]); </span>
<span id="cb56-40"><a href="#cb56-40" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-41"><a href="#cb56-41" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb56-42"><a href="#cb56-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-43"><a href="#cb56-43" aria-hidden="true" tabindex="-1"></a>generated quantities {</span>
<span id="cb56-44"><a href="#cb56-44" aria-hidden="true" tabindex="-1"></a>    int ypred[D,P];               </span>
<span id="cb56-45"><a href="#cb56-45" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span>(d <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>D){</span>
<span id="cb56-46"><a href="#cb56-46" aria-hidden="true" tabindex="-1"></a>    ypred[d,] <span class="ot">=</span> <span class="fu">multinomial_rng</span>(theta[d, ], <span class="fu">sum</span>(y[d, ])); </span>
<span id="cb56-47"><a href="#cb56-47" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb56-48"><a href="#cb56-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Preparando el código de <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-53_54c961cc234f9a954bdad779d852b265">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># file.edit("../Data/modelosStan/12ModeloMultinomial.stan")</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>fitMultinomial <span class="ot">&lt;-</span> <span class="fu">cmdstan_model</span>(<span class="at">stan_file =</span> <span class="st">"../Data/modelosStan/12ModeloMultinomial.stan"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Organizando datos para <code>STAN</code></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-54_e8fe9e9c0b08ce986ec9dfeb3ad6a4fa">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>Xdat <span class="ot">&lt;-</span> <span class="fu">model.matrix</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  Ocupado <span class="sc">~</span> tasa_desocupacion <span class="sc">+</span> </span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>    suelo_cultivos  <span class="sc">+</span> </span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>    suelo_urbanos <span class="sc">+</span> </span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>    alfabeta <span class="sc">+</span> </span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>    rezago_escolar  ,</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">data =</span> dataMultinomial</span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(Xdat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> (Intercept) </th>
   <th style="text-align:right;"> tasa_desocupacion </th>
   <th style="text-align:right;"> suelo_cultivos </th>
   <th style="text-align:right;"> suelo_urbanos </th>
   <th style="text-align:right;"> alfabeta </th>
   <th style="text-align:right;"> rezago_escolar </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0340 </td>
   <td style="text-align:right;"> 12.3671 </td>
   <td style="text-align:right;"> 13.5749 </td>
   <td style="text-align:right;"> 0.0662 </td>
   <td style="text-align:right;"> 0.1776 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0351 </td>
   <td style="text-align:right;"> 25.3519 </td>
   <td style="text-align:right;"> 0.9920 </td>
   <td style="text-align:right;"> 0.1377 </td>
   <td style="text-align:right;"> 0.0573 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0230 </td>
   <td style="text-align:right;"> 9.2249 </td>
   <td style="text-align:right;"> 7.4542 </td>
   <td style="text-align:right;"> 0.1023 </td>
   <td style="text-align:right;"> 0.1084 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0151 </td>
   <td style="text-align:right;"> 11.8985 </td>
   <td style="text-align:right;"> 3.1658 </td>
   <td style="text-align:right;"> 0.1628 </td>
   <td style="text-align:right;"> 0.0519 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0525 </td>
   <td style="text-align:right;"> 35.2899 </td>
   <td style="text-align:right;"> 2.2458 </td>
   <td style="text-align:right;"> 0.1362 </td>
   <td style="text-align:right;"> 0.0512 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0305 </td>
   <td style="text-align:right;"> 26.5864 </td>
   <td style="text-align:right;"> 0.8061 </td>
   <td style="text-align:right;"> 0.1482 </td>
   <td style="text-align:right;"> 0.0524 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0143 </td>
   <td style="text-align:right;"> 8.7206 </td>
   <td style="text-align:right;"> 3.7948 </td>
   <td style="text-align:right;"> 0.2897 </td>
   <td style="text-align:right;"> 0.0421 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0161 </td>
   <td style="text-align:right;"> 11.9767 </td>
   <td style="text-align:right;"> 5.8417 </td>
   <td style="text-align:right;"> 0.2904 </td>
   <td style="text-align:right;"> 0.0366 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0207 </td>
   <td style="text-align:right;"> 18.2660 </td>
   <td style="text-align:right;"> 6.0706 </td>
   <td style="text-align:right;"> 0.1692 </td>
   <td style="text-align:right;"> 0.1123 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0338 </td>
   <td style="text-align:right;"> 29.3599 </td>
   <td style="text-align:right;"> 1.6822 </td>
   <td style="text-align:right;"> 0.1993 </td>
   <td style="text-align:right;"> 0.0508 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0426 </td>
   <td style="text-align:right;"> 37.4208 </td>
   <td style="text-align:right;"> 1.4296 </td>
   <td style="text-align:right;"> 0.1704 </td>
   <td style="text-align:right;"> 0.0539 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0255 </td>
   <td style="text-align:right;"> 13.9958 </td>
   <td style="text-align:right;"> 2.6080 </td>
   <td style="text-align:right;"> 0.2222 </td>
   <td style="text-align:right;"> 0.0489 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0210 </td>
   <td style="text-align:right;"> 11.8076 </td>
   <td style="text-align:right;"> 1.5148 </td>
   <td style="text-align:right;"> 0.3038 </td>
   <td style="text-align:right;"> 0.0404 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0166 </td>
   <td style="text-align:right;"> 10.0401 </td>
   <td style="text-align:right;"> 0.7361 </td>
   <td style="text-align:right;"> 0.3674 </td>
   <td style="text-align:right;"> 0.0277 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0201 </td>
   <td style="text-align:right;"> 12.8529 </td>
   <td style="text-align:right;"> 0.4211 </td>
   <td style="text-align:right;"> 0.2711 </td>
   <td style="text-align:right;"> 0.0481 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0224 </td>
   <td style="text-align:right;"> 12.5184 </td>
   <td style="text-align:right;"> 0.4974 </td>
   <td style="text-align:right;"> 0.3490 </td>
   <td style="text-align:right;"> 0.0367 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0248 </td>
   <td style="text-align:right;"> 28.4407 </td>
   <td style="text-align:right;"> 0.2350 </td>
   <td style="text-align:right;"> 0.2250 </td>
   <td style="text-align:right;"> 0.0454 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0346 </td>
   <td style="text-align:right;"> 27.9997 </td>
   <td style="text-align:right;"> 0.6191 </td>
   <td style="text-align:right;"> 0.1910 </td>
   <td style="text-align:right;"> 0.0431 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0360 </td>
   <td style="text-align:right;"> 34.2277 </td>
   <td style="text-align:right;"> 1.5445 </td>
   <td style="text-align:right;"> 0.1850 </td>
   <td style="text-align:right;"> 0.0593 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0247 </td>
   <td style="text-align:right;"> 36.7507 </td>
   <td style="text-align:right;"> 1.0935 </td>
   <td style="text-align:right;"> 0.2760 </td>
   <td style="text-align:right;"> 0.0497 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0171 </td>
   <td style="text-align:right;"> 36.0126 </td>
   <td style="text-align:right;"> 1.4146 </td>
   <td style="text-align:right;"> 0.2224 </td>
   <td style="text-align:right;"> 0.0503 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1 </td>
   <td style="text-align:right;"> 0.0254 </td>
   <td style="text-align:right;"> 52.3791 </td>
   <td style="text-align:right;"> 1.2857 </td>
   <td style="text-align:right;"> 0.1929 </td>
   <td style="text-align:right;"> 0.0497 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-55_dff85c542d550cbca60bc872ed363a7c">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>ydat <span class="ot">&lt;-</span> dataMultinomial <span class="sc">%&gt;%</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(Ocupado, Desocupado, Inactivo) <span class="sc">%&gt;%</span> </span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as.matrix</span>()</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tba</span>(ydat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> Ocupado </th>
   <th style="text-align:right;"> Desocupado </th>
   <th style="text-align:right;"> Inactivo </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 1863 </td>
   <td style="text-align:right;"> 70 </td>
   <td style="text-align:right;"> 737 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 657 </td>
   <td style="text-align:right;"> 21 </td>
   <td style="text-align:right;"> 463 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1566 </td>
   <td style="text-align:right;"> 36 </td>
   <td style="text-align:right;"> 664 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 962 </td>
   <td style="text-align:right;"> 15 </td>
   <td style="text-align:right;"> 387 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1076 </td>
   <td style="text-align:right;"> 47 </td>
   <td style="text-align:right;"> 642 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 594 </td>
   <td style="text-align:right;"> 24 </td>
   <td style="text-align:right;"> 359 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 795 </td>
   <td style="text-align:right;"> 18 </td>
   <td style="text-align:right;"> 416 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 792 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 438 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1135 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 671 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1003 </td>
   <td style="text-align:right;"> 39 </td>
   <td style="text-align:right;"> 522 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 673 </td>
   <td style="text-align:right;"> 9 </td>
   <td style="text-align:right;"> 354 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 683 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 405 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 696 </td>
   <td style="text-align:right;"> 2 </td>
   <td style="text-align:right;"> 513 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 739 </td>
   <td style="text-align:right;"> 8 </td>
   <td style="text-align:right;"> 472 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 562 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 296 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 715 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 361 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 890 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 480 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 556 </td>
   <td style="text-align:right;"> 6 </td>
   <td style="text-align:right;"> 390 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 616 </td>
   <td style="text-align:right;"> 13 </td>
   <td style="text-align:right;"> 262 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 591 </td>
   <td style="text-align:right;"> 14 </td>
   <td style="text-align:right;"> 332 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 735 </td>
   <td style="text-align:right;"> 7 </td>
   <td style="text-align:right;"> 444 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 918 </td>
   <td style="text-align:right;"> 16 </td>
   <td style="text-align:right;"> 742 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-56_434d830a796f4784516d81990ceca7ee">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>sample_data <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">D =</span> <span class="fu">nrow</span>(dataMultinomial),</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>                    <span class="at">K =</span> <span class="fu">ncol</span>(Xdat),</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>                    <span class="at">X =</span> <span class="fu">as.matrix</span>(Xdat),</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>                    <span class="at">P =</span> <span class="fu">ncol</span>(ydat),</span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">y =</span> ydat</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a>                    )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Para ejecutar <code>STAN</code> en R tenemos la librería <em>cmdstanr</em></p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-57_9880d62009520802c7b7283ff45475f5">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Tiempo 5 minutos </span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>model_Multinomial <span class="ot">&lt;-</span> fitMultinomial<span class="sc">$</span><span class="fu">sample</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                 <span class="at">data =</span> sample_data, </span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_samples =</span> <span class="dv">1000</span>,</span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">num_warmup =</span> <span class="dv">1000</span>,</span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>                 <span class="at">chains =</span> <span class="dv">4</span>,</span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>                 <span class="at">parallel_chains =</span> <span class="dv">4</span>,</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a>                 <span class="at">seed =</span> <span class="dv">1234</span>,</span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>                 <span class="at">refresh =</span> <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Running MCMC with 4 parallel chains...

Chain 1 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 2 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 3 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration:    1 / 2000 [  0%]  (Warmup) 
Chain 4 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 4 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 2 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 2 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 3 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 3 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 1 Iteration: 1000 / 2000 [ 50%]  (Warmup) 
Chain 1 Iteration: 1001 / 2000 [ 50%]  (Sampling) 
Chain 4 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 4 finished in 25.3 seconds.
Chain 3 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 3 finished in 27.6 seconds.
Chain 2 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 2 finished in 28.0 seconds.
Chain 1 Iteration: 2000 / 2000 [100%]  (Sampling) 
Chain 1 finished in 29.6 seconds.

All 4 chains finished successfully.
Mean chain execution time: 27.6 seconds.
Total execution time: 29.8 seconds.</code></pre>
</div>
</div>
<p>La estimación del parámetro <span class="math inline">\(B\)</span> es:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-58_03597b57579e4a101932aee0a3b7b359">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>model_Multinomial<span class="sc">$</span><span class="fu">summary</span>(<span class="at">variables =</span> <span class="fu">c</span>(<span class="st">"beta"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(variable<span class="sc">:</span>q95) <span class="sc">%&gt;%</span> <span class="fu">tba</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<table class="table table-striped lightable-classic" style="width: auto !important; margin-left: auto; margin-right: auto; font-family: Arial Narrow; width: auto !important; margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:left;"> variable </th>
   <th style="text-align:right;"> mean </th>
   <th style="text-align:right;"> median </th>
   <th style="text-align:right;"> sd </th>
   <th style="text-align:right;"> mad </th>
   <th style="text-align:right;"> q5 </th>
   <th style="text-align:right;"> q95 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:left;"> beta[1,1] </td>
   <td style="text-align:right;"> -3.7702 </td>
   <td style="text-align:right;"> -3.7608 </td>
   <td style="text-align:right;"> 0.5178 </td>
   <td style="text-align:right;"> 0.5156 </td>
   <td style="text-align:right;"> -4.6271 </td>
   <td style="text-align:right;"> -2.9359 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,1] </td>
   <td style="text-align:right;"> -0.8526 </td>
   <td style="text-align:right;"> -0.8496 </td>
   <td style="text-align:right;"> 0.1226 </td>
   <td style="text-align:right;"> 0.1234 </td>
   <td style="text-align:right;"> -1.0560 </td>
   <td style="text-align:right;"> -0.6556 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,2] </td>
   <td style="text-align:right;"> 20.2134 </td>
   <td style="text-align:right;"> 20.2324 </td>
   <td style="text-align:right;"> 6.6483 </td>
   <td style="text-align:right;"> 6.4955 </td>
   <td style="text-align:right;"> 9.0439 </td>
   <td style="text-align:right;"> 31.1590 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,2] </td>
   <td style="text-align:right;"> -0.6358 </td>
   <td style="text-align:right;"> -0.6617 </td>
   <td style="text-align:right;"> 1.7090 </td>
   <td style="text-align:right;"> 1.7220 </td>
   <td style="text-align:right;"> -3.3875 </td>
   <td style="text-align:right;"> 2.2474 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,3] </td>
   <td style="text-align:right;"> 0.0021 </td>
   <td style="text-align:right;"> 0.0023 </td>
   <td style="text-align:right;"> 0.0064 </td>
   <td style="text-align:right;"> 0.0064 </td>
   <td style="text-align:right;"> -0.0086 </td>
   <td style="text-align:right;"> 0.0123 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,3] </td>
   <td style="text-align:right;"> 0.0070 </td>
   <td style="text-align:right;"> 0.0070 </td>
   <td style="text-align:right;"> 0.0014 </td>
   <td style="text-align:right;"> 0.0014 </td>
   <td style="text-align:right;"> 0.0047 </td>
   <td style="text-align:right;"> 0.0094 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,4] </td>
   <td style="text-align:right;"> 0.0704 </td>
   <td style="text-align:right;"> 0.0702 </td>
   <td style="text-align:right;"> 0.0460 </td>
   <td style="text-align:right;"> 0.0471 </td>
   <td style="text-align:right;"> -0.0055 </td>
   <td style="text-align:right;"> 0.1452 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,4] </td>
   <td style="text-align:right;"> -0.0144 </td>
   <td style="text-align:right;"> -0.0145 </td>
   <td style="text-align:right;"> 0.0103 </td>
   <td style="text-align:right;"> 0.0105 </td>
   <td style="text-align:right;"> -0.0311 </td>
   <td style="text-align:right;"> 0.0027 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,5] </td>
   <td style="text-align:right;"> -3.0865 </td>
   <td style="text-align:right;"> -3.0875 </td>
   <td style="text-align:right;"> 1.3400 </td>
   <td style="text-align:right;"> 1.3455 </td>
   <td style="text-align:right;"> -5.2933 </td>
   <td style="text-align:right;"> -0.8954 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,5] </td>
   <td style="text-align:right;"> 0.7670 </td>
   <td style="text-align:right;"> 0.7648 </td>
   <td style="text-align:right;"> 0.2935 </td>
   <td style="text-align:right;"> 0.2964 </td>
   <td style="text-align:right;"> 0.2990 </td>
   <td style="text-align:right;"> 1.2597 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[1,6] </td>
   <td style="text-align:right;"> -5.4230 </td>
   <td style="text-align:right;"> -5.3912 </td>
   <td style="text-align:right;"> 4.4006 </td>
   <td style="text-align:right;"> 4.4288 </td>
   <td style="text-align:right;"> -12.4412 </td>
   <td style="text-align:right;"> 1.7863 </td>
  </tr>
  <tr>
   <td style="text-align:left;"> beta[2,6] </td>
   <td style="text-align:right;"> 0.1573 </td>
   <td style="text-align:right;"> 0.1602 </td>
   <td style="text-align:right;"> 0.9846 </td>
   <td style="text-align:right;"> 1.0019 </td>
   <td style="text-align:right;"> -1.4475 </td>
   <td style="text-align:right;"> 1.7650 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-59_8fb0f336e21bdd48065bc206588e1e98">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_areas</span>(model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-60_5f2c212a4aa4d72ce325c13737e4f587">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mcmc_trace</span>(model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="st">"beta"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-60-1.png" style="height:200.0%" width="672"></p>
</div>
</div>
<p>La predicción del número de persona en cada estado se obtiene como:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-61_69a862dcae228daf5e38643b8afd7135">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>ydat2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ydat)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"ypred"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> ydat2, </span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a>                 y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para la probabilidad de pertenecer al estado <span class="math inline">\(k-esimo\)</span> se obtiene como:</p>
<div class="cell" data-hash="0Recursos/2Modelos/unnamed-chunk-62_15cf96e5d4e36dcd70692a598e2073d8">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>ydat2 <span class="ot">&lt;-</span> <span class="fu">as.vector</span>(ydat<span class="sc">/</span><span class="fu">rowSums</span>(ydat))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>y_pred_B <span class="ot">&lt;-</span> model_Multinomial<span class="sc">$</span><span class="fu">draws</span>(<span class="at">variables =</span> <span class="st">"theta"</span>, <span class="at">format =</span> <span class="st">"matrix"</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>rowsrandom <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(y_pred_B), <span class="dv">100</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>y_pred2 <span class="ot">&lt;-</span> y_pred_B[rowsrandom, ]</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ppc_dens_overlay</span>(<span class="at">y =</span> ydat2, </span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>                 y_pred2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="0Recursos/2Modelos/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>